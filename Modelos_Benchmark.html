
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Implementación de Modelos de Benchmark para Series de Tiempo &#8212; Análisis Predictivo de Series de Tiempo Aplicado a Precios Históricos del Oro</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Modelos_Benchmark';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Modelo Avanzado de Predicción: CNN-LSTM con Atención para Series Temporales de Divisas" href="Modelo_custom.html" />
    <link rel="prev" title="Análisis y Modelado Predictivo de Series de Tiempo Aplicado a Precios Históricos" href="Introducion_EDA.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Análisis Predictivo de Series de Tiempo Aplicado a Precios Históricos del Oro - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Análisis Predictivo de Series de Tiempo Aplicado a Precios Históricos del Oro - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Proyecto Felipe barrios
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Introducion_EDA.html">Análisis y Modelado Predictivo de Series de Tiempo Aplicado a Precios Históricos</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Implementación de Modelos de Benchmark para Series de Tiempo</a></li>











<li class="toctree-l1"><a class="reference internal" href="Modelo_custom.html">Modelo Avanzado de Predicción: CNN-LSTM con Atención para Series Temporales de Divisas</a></li>



</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FModelos_Benchmark.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Modelos_Benchmark.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Implementación de Modelos de Benchmark para Series de Tiempo</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Implementación de Modelos de Benchmark para Series de Tiempo</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objetivo-de-los-modelos-de-benchmark">Objetivo de los Modelos de Benchmark</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#division-del-conjunto-de-datos-y-definicion-de-metricas-de-evaluacion">División del Conjunto de Datos y Definición de Métricas de Evaluación</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#implementacion-del-modelo-de-suavizado-exponencial-exponential-smoothing-es">Implementación del Modelo de Suavizado Exponencial (Exponential Smoothing - ES)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#optimizacion-de-parametros-del-modelo-de-suavizado-exponencial-es">Optimización de Parámetros del Modelo de Suavizado Exponencial (ES)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-los-resultados-del-modelo-de-suavizado-exponencial-es">Interpretación de los Resultados del Modelo de Suavizado Exponencial (ES)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resultados-del-modelo">Resultados del Modelo</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-los-resultados">Interpretación de los Resultados</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mejora-del-modelo-de-suavizado-exponencial-es-usando-ventanas-deslizantes">Mejora del Modelo de Suavizado Exponencial (ES) Usando Ventanas Deslizantes</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#proceso">Proceso</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-de-suavizado-exponencial-es-usando-ventanas-deslizantes">Modelo de Suavizado Exponencial (ES) Usando Ventanas Deslizantes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-los-resultados-del-modelo-de-suavizado-exponencial-es-usando-ventanas-deslizantes">Interpretación de los Resultados del Modelo de Suavizado Exponencial (ES) Usando Ventanas Deslizantes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resultados-del-modelo-ventanas-deslizantes">Resultados del Modelo (Ventanas Deslizantes)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Interpretación de los Resultados</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparacion-con-el-modelo-anterior-sin-ventanas-deslizantes">Comparación con el Modelo Anterior (Sin Ventanas Deslizantes)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#indicios-de-sobreajuste">Indicios de Sobreajuste</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-la-tendencia-grafica">Análisis de la Tendencia Gráfica</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion-general-sobre-el-modelo-de-suavizado-exponencial-es">Conclusión General sobre el Modelo de Suavizado Exponencial (ES)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#consideraciones-finales-sobre-el-modelo-es">Consideraciones Finales sobre el Modelo ES:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementacion-del-modelo-holt-winters">Implementacion del Modelo Holt-Winters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parametros">Parámetros</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-los-resultados-del-modelo-holt-winters-hs-para-usd-y-eur">Interpretación de los Resultados del Modelo Holt-Winters (HS) para USD y EUR</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resultados-del-modelo-holt-winters-para-usd-y-eur">Resultados del Modelo Holt-Winters para USD y EUR</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-los-resultados-para-usd-y-eur">Interpretación de los Resultados para USD y EUR</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#captura-de-la-tendencia">Captura de la Tendencia</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusiones-generales-sobre-el-modelo-holt-winters-h-w">Conclusiónes Generales sobre el Modelo Holt-Winters (H-W)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluacion-de-potenciales-periodos-estacionales-para-el-modelo-holt-winters">Evaluación de Potenciales Periodos Estacionales para el Modelo Holt-Winters</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resultados-de-los-periodos-estacionales-para-el-modelo-holt-winters">Resultados de los Periodos Estacionales para el Modelo Holt-Winters</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#precision-de-las-predicciones">Precisión de las Predicciones:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-alpha-beta-y-gamma">Análisis de Alpha, Beta y Gamma:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion-del-componente-estacional">Conclusión del Componente Estacional:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizacion-y-comparacion-grafica-de-modelos-estacionales-y-benchmark">Visualización y Comparación Gráfica de Modelos Estacionales y Benchmark</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-los-resultados-de-los-modelos-estacionales-y-benchmark">Interpretación de los Resultados de los Modelos Estacionales y Benchmark</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Interpretación de los Resultados:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-grafico">Análisis Gráfico :</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion-general-del-modelo-holt-winters-para-los-precios-del-oro">Conclusión General del Modelo Holt-Winters para los Precios del Oro</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#introduccion-al-modelo-arima">Introducción al Modelo ARIMA</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#implementacion-del-modelo-arima-para-prediccion-de-precios-del-oro">Implementación del Modelo ARIMA para Predicción de Precios del Oro</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transformacion-en-la-serie-de-precios-del-oro">Transformación en la Serie de Precios del Oro</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#aplicacion-de-transformacion-con-difrenciacion">Aplicacion de Transformación con difrenciacion</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resultados-de-la-transformacion-logaritmica-con-diferenciacion">Resultados de la Transformación Logarítmica con Diferenciación</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#observaciones">Observaciones</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#graficos-acf-y-pacf">Gráficos ACF y PACF</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizacion-de-graficos-acf-y-pacf">Visualizacion de Gráficos ACF y PACF</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-las-graficas-acf-y-pacf">Interpretación de las Gráficas ACF y PACF</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parametros-iniciales-del-modelo-arima">Parámetros Iniciales del Modelo ARIMA</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optimizacion-de-parametros-modelo-arima">Optimizacion de parametros Modelo ARIMA</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-los-resultados-del-modelo-arima-para-usd-y-eur">Interpretación de los Resultados del Modelo ARIMA para USD y EUR</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#comparacion-de-los-resultados">Comparación de los Resultados</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#entrenamiento-evaluacion-y-visualizacion-de-los-modelos-arima">Entrenamiento, Evaluación y Visualización de los Modelos ARIMA</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Interpretación de los Resultados del Modelo ARIMA para USD y EUR</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-comparativo-con-el-modelo-holt-winters">Análisis Comparativo con el Modelo Holt-Winters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#falta-de-ajuste-a-la-tendencia">Falta de Ajuste a la Tendencia</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optimizacion-del-modelo-arima-mediante-grid-search-basado-en-rmse">Optimización del Modelo ARIMA mediante Grid Search basado en RMSE</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-los-resultados-del-arima-optimizado-para-usd-y-eur">Interpretación de los Resultados del ARIMA Optimizado para USD y EUR</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparacion-y-rendimiento">Comparación y Rendimiento</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion-final-del-modelo-arima">Conclusión Final del Modelo ARIMA</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementacion-del-modelo-de-redes-neuronales-artificiales-ann-para-prediccion-de-precios-del-oro">Implementación del Modelo de Redes Neuronales Artificiales (ANN) para Predicción de Precios del Oro</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocesamiento-de-datos-normalizacion-de-las-divisas-usd-y-eur">Preprocesamiento de Datos: Normalización de las Divisas USD y EUR</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocesamiento-de-datos-normalizacion-conjunta-de-las-divisas-usd-y-eur">Preprocesamiento de Datos: Normalización Conjunta de las Divisas USD y EUR</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optimizacion-del-tamano-de-la-ventana-en-el-modelo-ann">Optimización del Tamaño de la Ventana en el Modelo ANN</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#implementacion-y-entrenamiento-de-modelos-ann-para-prediccion-individual-de-usd-y-eur">Implementación y Entrenamiento de Modelos ANN para Predicción Individual de USD y EUR</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-resultados-y-graficos-para-modelos-ann-en-usd-y-eur">Interpretación de Resultados y Gráficos para Modelos ANN en USD y EUR</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-las-metricas-de-error">Interpretación de las Métricas de Error</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-los-graficos-de-prediccion">Análisis de los Gráficos de Predicción</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusiones-finales">Conclusiones Finales</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="implementacion-de-modelos-de-benchmark-para-series-de-tiempo">
<h1>Implementación de Modelos de Benchmark para Series de Tiempo<a class="headerlink" href="#implementacion-de-modelos-de-benchmark-para-series-de-tiempo" title="Link to this heading">#</a></h1>
<p>En esta etapa del análisis, se procederá a la <strong>implementación de modelos de benchmark</strong> para los precios del oro en <strong>USD</strong> y <strong>EUR</strong>. El objetivo es evaluar y comparar el rendimiento de diferentes enfoques, para determinar cuáles son más adecuados para modelar y predecir el comportamiento de la serie de tiempo y tener un punto de comparacion en el momento de implementar el modelo personalizado de este proyecto.</p>
<p>Los modelos de benchmark a desarrollar seran los siguientes:</p>
<ol class="arabic simple">
<li><p><strong>Exponential Smoothing (ES)</strong>:</p>
<ul class="simple">
<li><p>El <strong>Suavizado Exponencial</strong> se usará como punto de partida para predecir series de tiempo simples sin componentes estacionales complejos.</p></li>
</ul>
</li>
<li><p><strong>Holt-Winters</strong>:</p>
<ul class="simple">
<li><p>El <strong>Modelo Holt-Winters</strong> es una extensión del ES con la capacidad de incorporar <strong>tendencia y estacionalidad</strong>.</p></li>
<li><p>Permitirá observar cómo la inclusión de estos componentes influye en la calidad de las predicciones.</p></li>
</ul>
</li>
<li><p><strong>ARIMA</strong>:</p>
<ul class="simple">
<li><p><strong>ARIMA (Autoregressive Integrated Moving Average)</strong> es un modelo que requiere <strong>estacionariedad</strong>. Por ello, se deberan aplicar transformaciones a la serie con diferenciación para lograr estabilidad.</p></li>
<li><p>Este modelo puede ser particularmente útil para este caso gracias a que las series muestran patrones de autocorrelación.</p></li>
</ul>
</li>
<li><p><strong>Artificial Neural Networks (ANNs)</strong>:</p>
<ul class="simple">
<li><p>Se implementarán <strong>Redes Neuronales Artificiales</strong> para aprovechar la capacidad de <strong>aprendizaje no lineal</strong>.</p></li>
<li><p>Este modelo podria detectar patrones complejos en la tendecia de los precios del oro y captar la volatilidad de este.</p></li>
</ul>
</li>
</ol>
<section id="objetivo-de-los-modelos-de-benchmark">
<h2>Objetivo de los Modelos de Benchmark<a class="headerlink" href="#objetivo-de-los-modelos-de-benchmark" title="Link to this heading">#</a></h2>
<p>El propósito de implementar estos <strong>cuatro modelos de benchmark</strong> es establecer un conjunto de comparaciones sólidas que permitan evaluar cuál de ellos ofrece la mejor precisión en la predicción de los precios del oro.
Esto se hara comparando cómo cada modelo maneja los componentes <strong>tendencia</strong>, <strong>estacionalidad</strong>, y <strong>ruido</strong> presentes en los datos. Estas comparaciones servirán como referencia en el futuro para evaluar el modelo personalizado en una etapa posterior.</p>
</section>
</section>
<section id="division-del-conjunto-de-datos-y-definicion-de-metricas-de-evaluacion">
<h1>División del Conjunto de Datos y Definición de Métricas de Evaluación<a class="headerlink" href="#division-del-conjunto-de-datos-y-definicion-de-metricas-de-evaluacion" title="Link to this heading">#</a></h1>
<p>Para garantizar una evaluación consistente de los modelos de benchmark, se procederá a dividir el conjunto de datos en subconjuntos <strong>entrenamiento</strong> y <strong>prueba</strong>, ademas se definiran las metricas de mediccion que seran usadas para todos los modelos dentro de este proyecto.</p>
<ul class="simple">
<li><p><strong>División del Conjunto de Datos</strong>:</p>
<ul>
<li><p>Se dividirán los datos en <strong>80% para entrenamiento</strong> y <strong>20% para prueba</strong>.</p></li>
<li><p>Esta división permitirá entrenar los modelos en una gran porción del dataset y luego evaluar su rendimiento en datos no entranados.</p></li>
</ul>
</li>
<li><p><strong>Métricas de Evaluación</strong>:</p>
<ul>
<li><p>Las métricas de evaluación seleccionadas son:</p>
<ul>
<li><p><strong>Root Mean Square Error (RMSE)</strong>: Para medir la diferencia promedio entre los valores predichos y los valores reales.</p></li>
<li><p><strong>Mean Absolute Error (MAE)</strong>: Para medir el error absoluto medio entre los valores predichos y reales.</p></li>
<li><p><strong>Mean Absolute Percentage Error (MAPE)</strong>: Para medir el error en términos relativos y proporcionar un valor porcentual más facil de interpretar.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Estas métricas se utilizarán de manera consistente en todos los modelos para garantizar una <strong>comparación justa</strong> y cuantificar con precisión el rendimiento de cada uno de ellos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Cargar el conjunto de datos optimizado.</span>
<span class="n">daily_gold_rate_benchmark</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;daily_gold_rate.csv&#39;</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">])</span>
<span class="n">daily_gold_rate_benchmark</span> <span class="o">=</span> <span class="n">daily_gold_rate_benchmark</span><span class="p">[[</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="s1">&#39;USD&#39;</span><span class="p">,</span> <span class="s1">&#39;EUR&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="c1"># División del conjunto de datos en entrenamiento y prueba (80% entrenamiento, 20% prueba)</span>
<span class="n">train_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">daily_gold_rate_benchmark</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
<span class="n">train_data</span> <span class="o">=</span> <span class="n">daily_gold_rate_benchmark</span><span class="p">[:</span><span class="n">train_size</span><span class="p">]</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="n">daily_gold_rate_benchmark</span><span class="p">[</span><span class="n">train_size</span><span class="p">:]</span>

<span class="c1"># Imprimir detalles de la división</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Datos de entrenamiento: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">train_data</span><span class="p">)</span><span class="si">}</span><span class="s2"> filas&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Datos de prueba: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span><span class="si">}</span><span class="s2"> filas&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Datos de entrenamiento: 8091 filas
Datos de prueba: 2023 filas
</pre></div>
</div>
</div>
</div>
</section>
<section id="implementacion-del-modelo-de-suavizado-exponencial-exponential-smoothing-es">
<h1>Implementación del Modelo de Suavizado Exponencial (Exponential Smoothing - ES)<a class="headerlink" href="#implementacion-del-modelo-de-suavizado-exponencial-exponential-smoothing-es" title="Link to this heading">#</a></h1>
<p>El <strong>Suavizado Exponencial (ES)</strong> es un método de predicción que se basa en la ponderación de observaciones previas para la prediccion de datos futuros, con un mayor peso en las observaciones más recientes. Este modelo es adecuado para series de tiempo sin componentes estacionales complejos. En este caso, al no mostrarse una estacionalidad clara, no se espera que este modelo ni su variación <strong>Holt-Winters</strong> sean los más adecuados, por lo que este se usará como una <strong>línea base</strong> del desempeño de los modelos de predicción para los precios del oro.</p>
</section>
<section id="optimizacion-de-parametros-del-modelo-de-suavizado-exponencial-es">
<h1>Optimización de Parámetros del Modelo de Suavizado Exponencial (ES)<a class="headerlink" href="#optimizacion-de-parametros-del-modelo-de-suavizado-exponencial-es" title="Link to this heading">#</a></h1>
<p>Se procederá a <strong>optimizar manualmente los parámetros</strong> del modelo de <strong>Suavizado Exponencial Simple (ES)</strong> para mejorar el rendimiento. Esto se llevará a cabo a través de una <strong>Grid Search</strong> para encontrar el valor óptimo del coeficiente de suavizado <code class="docutils literal notranslate"><span class="pre">alpha</span></code>. Además de la optimización, se considerarán otras mejoras en el modelo dependiendo de los resultados.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importar las librerías necesarias</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_error</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.holtwinters</span> <span class="kn">import</span> <span class="n">ExponentialSmoothing</span>

<span class="c1"># Establecer &#39;Date&#39; como índice para el análisis de ES</span>
<span class="n">daily_gold_rate_es</span> <span class="o">=</span> <span class="n">daily_gold_rate_benchmark</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">daily_gold_rate_es</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Establecer la frecuencia del índice como diaria</span>
<span class="n">daily_gold_rate_es</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">daily_gold_rate_es</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">daily_gold_rate_es</span> <span class="o">=</span> <span class="n">daily_gold_rate_es</span><span class="o">.</span><span class="n">asfreq</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">)</span>  <span class="c1"># Días hábiles</span>

<span class="c1"># División del conjunto de datos en entrenamiento y prueba</span>
<span class="n">train_size_es</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">daily_gold_rate_es</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
<span class="n">train_data_es</span> <span class="o">=</span> <span class="n">daily_gold_rate_es</span><span class="p">[:</span><span class="n">train_size_es</span><span class="p">]</span>
<span class="n">test_data_es</span> <span class="o">=</span> <span class="n">daily_gold_rate_es</span><span class="p">[</span><span class="n">train_size_es</span><span class="p">:]</span>

<span class="c1"># Definir los valores posibles de los parámetros de suavizado</span>
<span class="n">alpha_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>  <span class="c1"># Valores posibles para alpha</span>

<span class="c1"># Función para optimizar el valor de alpha para una serie temporal dada</span>
<span class="k">def</span> <span class="nf">optimizar_alpha</span><span class="p">(</span><span class="n">currency_data</span><span class="p">,</span> <span class="n">test_data</span><span class="p">):</span>
    <span class="n">best_rmse</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
    <span class="n">best_alpha</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">best_model</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">best_mae</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">best_mape</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">alpha_values</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">ExponentialSmoothing</span><span class="p">(</span><span class="n">currency_data</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seasonal</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">smoothing_level</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
            <span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test_data</span><span class="p">))</span>
            
            <span class="c1"># Calcular métricas de error</span>
            <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">test_data</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
            <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">test_data</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
            <span class="n">mape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">test_data</span> <span class="o">-</span> <span class="n">predictions</span><span class="p">)</span> <span class="o">/</span> <span class="n">test_data</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>

            <span class="k">if</span> <span class="n">rmse</span> <span class="o">&lt;</span> <span class="n">best_rmse</span><span class="p">:</span>
                <span class="n">best_rmse</span> <span class="o">=</span> <span class="n">rmse</span>
                <span class="n">best_alpha</span> <span class="o">=</span> <span class="n">alpha</span>
                <span class="n">best_model</span> <span class="o">=</span> <span class="n">model</span>
                <span class="n">best_mae</span> <span class="o">=</span> <span class="n">mae</span>
                <span class="n">best_mape</span> <span class="o">=</span> <span class="n">mape</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error en alpha=</span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">continue</span>

    <span class="k">return</span> <span class="n">best_alpha</span><span class="p">,</span> <span class="n">best_rmse</span><span class="p">,</span> <span class="n">best_mae</span><span class="p">,</span> <span class="n">best_mape</span><span class="p">,</span> <span class="n">best_model</span>

<span class="c1"># Optimización de alpha para USD y EUR</span>
<span class="n">best_alpha_usd</span><span class="p">,</span> <span class="n">best_rmse_usd</span><span class="p">,</span> <span class="n">best_mae_usd</span><span class="p">,</span> <span class="n">best_mape_usd</span><span class="p">,</span> <span class="n">best_model_usd</span> <span class="o">=</span> <span class="n">optimizar_alpha</span><span class="p">(</span><span class="n">train_data_es</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">],</span> <span class="n">test_data_es</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">])</span>
<span class="n">best_alpha_eur</span><span class="p">,</span> <span class="n">best_rmse_eur</span><span class="p">,</span> <span class="n">best_mae_eur</span><span class="p">,</span> <span class="n">best_mape_eur</span><span class="p">,</span> <span class="n">best_model_eur</span> <span class="o">=</span> <span class="n">optimizar_alpha</span><span class="p">(</span><span class="n">train_data_es</span><span class="p">[</span><span class="s1">&#39;EUR&#39;</span><span class="p">],</span> <span class="n">test_data_es</span><span class="p">[</span><span class="s1">&#39;EUR&#39;</span><span class="p">])</span>

<span class="c1"># Imprimir resultados para USD</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejores parámetros para el modelo ES (USD): Alpha: </span><span class="si">{</span><span class="n">best_alpha_usd</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RMSE: </span><span class="si">{</span><span class="n">best_rmse_usd</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAE: </span><span class="si">{</span><span class="n">best_mae_usd</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE: </span><span class="si">{</span><span class="n">best_mape_usd</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

<span class="c1"># Imprimir resultados para EUR</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Mejores parámetros para el modelo ES (EUR): Alpha: </span><span class="si">{</span><span class="n">best_alpha_eur</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RMSE: </span><span class="si">{</span><span class="n">best_rmse_eur</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAE: </span><span class="si">{</span><span class="n">best_mae_eur</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE: </span><span class="si">{</span><span class="n">best_mape_eur</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

<span class="c1"># Graficar Comparativa de Valores Reales, Entrenamiento vs. Predichos (USD)</span>
<span class="n">predictions_usd</span> <span class="o">=</span> <span class="n">best_model_usd</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test_data_es</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="c1"># Graficar los datos de entrenamiento</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">daily_gold_rate_es</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">train_data_es</span><span class="p">)],</span> <span class="n">train_data_es</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Datos de Entrenamiento (USD)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">)</span>
<span class="c1"># Graficar los valores reales (datos de prueba)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_data_es</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">test_data_es</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Valores Reales (USD)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="c1"># Graficar los valores predichos</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_data_es</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">predictions_usd</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Valores Predichos (USD)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Precio del Oro (USD)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Comparación de Valores Reales, Entrenamiento vs. Predichos para USD&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Graficar Comparativa de Valores Reales, Entrenamiento vs. Predichos (EUR)</span>
<span class="n">predictions_eur</span> <span class="o">=</span> <span class="n">best_model_eur</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test_data_es</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="c1"># Graficar los datos de entrenamiento</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">daily_gold_rate_es</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">train_data_es</span><span class="p">)],</span> <span class="n">train_data_es</span><span class="p">[</span><span class="s1">&#39;EUR&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Datos de Entrenamiento (EUR)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">)</span>
<span class="c1"># Graficar los valores reales (datos de prueba)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_data_es</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">test_data_es</span><span class="p">[</span><span class="s1">&#39;EUR&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Valores Reales (EUR)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="c1"># Graficar los valores predichos</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_data_es</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">predictions_eur</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Valores Predichos (EUR)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Precio del Oro (EUR)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Comparación de Valores Reales, Entrenamiento vs. Predichos para EUR&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejores parámetros para el modelo ES (USD): Alpha: 0.01
RMSE: 501.4474892419373
MAE: 415.98265090915
MAPE: 24.423337661514076%

Mejores parámetros para el modelo ES (EUR): Alpha: 0.01
RMSE: 450.88327991268716
MAE: 363.491770533956
MAPE: 23.560429772186513%
</pre></div>
</div>
<img alt="_images/165c8357cb199633da351c2b0bdd77587b7e6169ffc2fec626a544227f0a4414.png" src="_images/165c8357cb199633da351c2b0bdd77587b7e6169ffc2fec626a544227f0a4414.png" />
<img alt="_images/fd08c8ba992f389062ffe2056a73a0bf8b13e545084686ab4b5c0d3c16f09208.png" src="_images/fd08c8ba992f389062ffe2056a73a0bf8b13e545084686ab4b5c0d3c16f09208.png" />
</div>
</div>
</section>
<section id="interpretacion-de-los-resultados-del-modelo-de-suavizado-exponencial-es">
<h1>Interpretación de los Resultados del Modelo de Suavizado Exponencial (ES)<a class="headerlink" href="#interpretacion-de-los-resultados-del-modelo-de-suavizado-exponencial-es" title="Link to this heading">#</a></h1>
<p>Después de optimizar los parámetros del modelo de <strong>Suavizado Exponencial (ES)</strong> aplicados a los precios del oro en <strong>USD</strong> y <strong>EUR</strong>, se obtuvieron los siguientes resultados:</p>
<section id="resultados-del-modelo">
<h2>Resultados del Modelo<a class="headerlink" href="#resultados-del-modelo" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>USD</strong>:</p>
<ul>
<li><p><strong>Alpha</strong>: 0.01</p></li>
<li><p><strong>RMSE</strong>: 501.45</p></li>
<li><p><strong>MAE</strong>: 415.98</p></li>
<li><p><strong>MAPE</strong>: 24.42%</p></li>
</ul>
</li>
<li><p><strong>EUR</strong>:</p>
<ul>
<li><p><strong>Alpha</strong>: 0.01</p></li>
<li><p><strong>RMSE</strong>: 450.88</p></li>
<li><p><strong>MAE</strong>: 363.49</p></li>
<li><p><strong>MAPE</strong>: 23.56%</p></li>
</ul>
</li>
</ul>
</section>
<section id="interpretacion-de-los-resultados">
<h2>Interpretación de los Resultados<a class="headerlink" href="#interpretacion-de-los-resultados" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Los resultados numéricos muestran un error considerablemente alto, tanto en <strong>USD</strong> como en <strong>EUR</strong>, con valores de <strong>RMSE</strong> y <strong>MAE</strong> que reflejan grandes diferencias entre los valores predichos y los valores reales.</p></li>
<li><p>En particular, los valores de <strong>MAPE</strong> en ambos casos son superiores al 20%, lo que indica que el modelo tiene una capacidad limitada para predecir con precisión los precios del oro.</p></li>
<li><p>Las gráficas comparativas muestran que el modelo predice una <strong>línea plana</strong> para los valores futuros, lo es representativo del bajo valor de <strong>Alpha</strong> (0.01). Esto significa que el modelo está basando sus predicciones en promedios históricos y no está capturando los cambios recientes en las tendencias del precio del oro.</p></li>
<li><p>Esta predicción plana sugiere que el modelo <strong>no es adecuado</strong> para capturar las fluctuaciones o la volatilidad de los precios del oro en ambos mercados (USD y EUR), lo que refuerza la necesidad de explorar otros enfoques más sofisticados, como <strong>Holt-Winters</strong> o <strong>ARIMA</strong>, que puedan capturar la estructura de los datos con mayor detalle.</p></li>
</ul>
</section>
</section>
<section id="mejora-del-modelo-de-suavizado-exponencial-es-usando-ventanas-deslizantes">
<h1>Mejora del Modelo de Suavizado Exponencial (ES) Usando Ventanas Deslizantes<a class="headerlink" href="#mejora-del-modelo-de-suavizado-exponencial-es-usando-ventanas-deslizantes" title="Link to this heading">#</a></h1>
<p>Con el objetivo de mejorar la precisión del modelo de <strong>Suavizado Exponencial (ES)</strong> aplicado a los precios del oro en <strong>USD</strong> y <strong>EUR</strong> a un nivel mas aceptable, se implementó un enfoque de <strong>ventanas deslizantes</strong>. Este método tiene como objetivo adaptar mejor el modelo a los valores más recientes y evaluar su rendimiento de manera continua a lo largo de un conjunto de validacion, esto debido a que como se menciono antes el modelo está basando sus predicciones en promedios históricos y no está capturando los cambios recientes en las tendencias del precio del oro</p>
<section id="proceso">
<h2>Proceso<a class="headerlink" href="#proceso" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong>División de los datos</strong>:</p>
<ul class="simple">
<li><p>El conjunto de datos se dividió en tres partes:</p>
<ul>
<li><p><strong>Entrenamiento</strong> (70% de los datos)</p></li>
<li><p><strong>Validación</strong> (15% de los datos)</p></li>
<li><p><strong>Prueba</strong> (15% de los datos)</p></li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Ventanas deslizantes</strong>:</p>
<ul class="simple">
<li><p>El modelo se entrena inicialmente con el conjunto de entrenamiento, ajustando sus parámetros con los datos de validación. Posteriormente, se desplaza la ventana hacia adelante, añadiendo nuevos datos a la base de entrenamiento y ajustando los parámetros del modelo en cada paso.</p></li>
<li><p>Este enfoque permite que el modelo se ajuste continuamente con datos de prediccion y del conjunto de validacion , lo que ayuda a capturar mejor las fluctuaciones en la serie temporal.</p></li>
</ul>
</li>
<li><p><strong>Optimización de parámetros</strong>:</p>
<ul class="simple">
<li><p>Se realizó una búsqueda de valores óptimos del parámetro <strong>Alpha</strong> dentro de un rango predefinido utilizando el conjunto de validación.</p></li>
<li><p>Tras ajustar los parámetros, el modelo se probó contra el conjunto de prueba para evaluar su capacidad predictiva final.</p></li>
</ul>
</li>
<li><p><strong>Evaluación del modelo</strong>:</p>
<ul class="simple">
<li><p>Se calcularon las métricas de error <strong>RMSE</strong>, <strong>MAE</strong>, y <strong>MAPE</strong> tanto en el conjunto de validación como en el conjunto de prueba para medir el desempeño del modelo ajustado y revisar si existe sobreajuste.</p></li>
</ul>
</li>
</ol>
</section>
<section id="modelo-de-suavizado-exponencial-es-usando-ventanas-deslizantes">
<h2>Modelo de Suavizado Exponencial (ES) Usando Ventanas Deslizantes<a class="headerlink" href="#modelo-de-suavizado-exponencial-es-usando-ventanas-deslizantes" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importar las librerías necesarias</span>
<span class="kn">from</span> <span class="nn">joblib</span> <span class="kn">import</span> <span class="n">Parallel</span><span class="p">,</span> <span class="n">delayed</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="c1"># Desactiva los warnings del sistema</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;PYTHONWARNINGS&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ignore&quot;</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="c1"># Establecer &#39;Date&#39; como índice para el análisis de ES</span>
<span class="n">daily_gold_rate_es</span> <span class="o">=</span> <span class="n">daily_gold_rate_benchmark</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">daily_gold_rate_es</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Establecer la frecuencia del índice como diaria </span>
<span class="n">daily_gold_rate_es</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">daily_gold_rate_es</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">daily_gold_rate_es</span> <span class="o">=</span> <span class="n">daily_gold_rate_es</span><span class="o">.</span><span class="n">asfreq</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">)</span>  <span class="c1"># Días hábiles</span>

<span class="c1"># División del conjunto de datos en entrenamiento (70%), validación (15%) y prueba (15%)</span>
<span class="n">train_size_es</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">daily_gold_rate_es</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.7</span><span class="p">)</span>
<span class="n">val_size_es</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">daily_gold_rate_es</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.15</span><span class="p">)</span>
<span class="n">test_size_es</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">daily_gold_rate_es</span><span class="p">)</span> <span class="o">-</span> <span class="n">train_size_es</span> <span class="o">-</span> <span class="n">val_size_es</span>

<span class="n">train_data_es</span> <span class="o">=</span> <span class="n">daily_gold_rate_es</span><span class="p">[:</span><span class="n">train_size_es</span><span class="p">]</span>
<span class="n">val_data_es</span> <span class="o">=</span> <span class="n">daily_gold_rate_es</span><span class="p">[</span><span class="n">train_size_es</span><span class="p">:</span><span class="n">train_size_es</span> <span class="o">+</span> <span class="n">val_size_es</span><span class="p">]</span>
<span class="n">test_data_es</span> <span class="o">=</span> <span class="n">daily_gold_rate_es</span><span class="p">[</span><span class="n">train_size_es</span> <span class="o">+</span> <span class="n">val_size_es</span><span class="p">:]</span>

<span class="c1"># Definir los valores posibles de los parámetros de suavizado</span>
<span class="n">alpha_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>  <span class="c1"># Valores posibles para alpha</span>

<span class="c1"># Función para ajustar el modelo y calcular el RMSE en validación</span>
<span class="k">def</span> <span class="nf">ajustar_modelo</span><span class="p">(</span><span class="n">currency</span><span class="p">,</span> <span class="n">alpha</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">ExponentialSmoothing</span><span class="p">(</span><span class="n">train_data_es</span><span class="p">[</span><span class="n">currency</span><span class="p">],</span> <span class="n">trend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seasonal</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">smoothing_level</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
        <span class="n">val_predictions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">history</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">train_data_es</span><span class="p">[</span><span class="n">currency</span><span class="p">])</span>  

        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">val_data_es</span><span class="p">)):</span>
            <span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">val_predictions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span>
            <span class="n">history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val_data_es</span><span class="p">[</span><span class="n">currency</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>  

        <span class="c1"># Calcular RMSE en el conjunto de validación</span>
        <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">val_data_es</span><span class="p">[</span><span class="n">currency</span><span class="p">],</span> <span class="n">val_predictions</span><span class="p">))</span>
        <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">val_data_es</span><span class="p">[</span><span class="n">currency</span><span class="p">],</span> <span class="n">val_predictions</span><span class="p">)</span>
        <span class="n">mape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">val_data_es</span><span class="p">[</span><span class="n">currency</span><span class="p">]</span> <span class="o">-</span> <span class="n">val_predictions</span><span class="p">)</span> <span class="o">/</span> <span class="n">val_data_es</span><span class="p">[</span><span class="n">currency</span><span class="p">]))</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">rmse</span><span class="p">,</span> <span class="n">mae</span><span class="p">,</span> <span class="n">mape</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error en alpha=</span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>

<span class="c1"># Ejecucion en paralelo usando 10 núcleos</span>
<span class="n">resultados_usd</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">10</span><span class="p">)(</span><span class="n">delayed</span><span class="p">(</span><span class="n">ajustar_modelo</span><span class="p">)(</span><span class="s1">&#39;USD&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span> <span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">alpha_values</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Optimizando USD&quot;</span><span class="p">))</span>
<span class="n">resultados_eur</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">10</span><span class="p">)(</span><span class="n">delayed</span><span class="p">(</span><span class="n">ajustar_modelo</span><span class="p">)(</span><span class="s1">&#39;EUR&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span> <span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">alpha_values</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Optimizando EUR&quot;</span><span class="p">))</span>

<span class="c1"># Encontrar el mejor modelo basado en RMSE para USD</span>
<span class="n">best_result_usd</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">resultados_usd</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">best_alpha_usd</span><span class="p">,</span> <span class="n">best_rmse_usd</span><span class="p">,</span> <span class="n">best_mae_usd</span><span class="p">,</span> <span class="n">best_mape_usd</span><span class="p">,</span> <span class="n">best_model_usd</span> <span class="o">=</span> <span class="n">best_result_usd</span>

<span class="c1"># Encontrar el mejor modelo basado en RMSE para EUR</span>
<span class="n">best_result_eur</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">resultados_eur</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">best_alpha_eur</span><span class="p">,</span> <span class="n">best_rmse_eur</span><span class="p">,</span> <span class="n">best_mae_eur</span><span class="p">,</span> <span class="n">best_mape_eur</span><span class="p">,</span> <span class="n">best_model_eur</span> <span class="o">=</span> <span class="n">best_result_eur</span>

<span class="c1"># Usar el mejor modelo encontrado para predecir sobre el conjunto de prueba</span>
<span class="k">def</span> <span class="nf">generar_predicciones</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">history</span><span class="p">,</span> <span class="n">test_data</span><span class="p">):</span>
    <span class="n">test_predictions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test_data</span><span class="p">)),</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Generando Predicciones&quot;</span><span class="p">):</span>
        <span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">test_predictions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span>
        <span class="n">history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span>  
    <span class="k">return</span> <span class="n">test_predictions</span>

<span class="n">test_predictions_usd</span> <span class="o">=</span> <span class="n">generar_predicciones</span><span class="p">(</span><span class="n">best_model_usd</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">train_data_es</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">val_data_es</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">]),</span> <span class="n">test_data_es</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">])</span>
<span class="n">test_predictions_eur</span> <span class="o">=</span> <span class="n">generar_predicciones</span><span class="p">(</span><span class="n">best_model_eur</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">train_data_es</span><span class="p">[</span><span class="s1">&#39;EUR&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">val_data_es</span><span class="p">[</span><span class="s1">&#39;EUR&#39;</span><span class="p">]),</span> <span class="n">test_data_es</span><span class="p">[</span><span class="s1">&#39;EUR&#39;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="mi">50</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Evaluar el rendimiento en el conjunto de prueba para USD</span>
<span class="n">rmse_test_usd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">test_data_es</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">],</span> <span class="n">test_predictions_usd</span><span class="p">))</span>
<span class="n">mae_test_usd</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">test_data_es</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">],</span> <span class="n">test_predictions_usd</span><span class="p">)</span>
<span class="n">mape_test_usd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">test_data_es</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">test_predictions_usd</span><span class="p">)</span> <span class="o">/</span> <span class="n">test_data_es</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">]))</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Evaluar el rendimiento en el conjunto de prueba para EUR</span>
<span class="n">rmse_test_eur</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">test_data_es</span><span class="p">[</span><span class="s1">&#39;EUR&#39;</span><span class="p">],</span> <span class="n">test_predictions_eur</span><span class="p">))</span>
<span class="n">mae_test_eur</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">test_data_es</span><span class="p">[</span><span class="s1">&#39;EUR&#39;</span><span class="p">],</span> <span class="n">test_predictions_eur</span><span class="p">)</span>
<span class="n">mape_test_eur</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">test_data_es</span><span class="p">[</span><span class="s1">&#39;EUR&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">test_predictions_eur</span><span class="p">)</span> <span class="o">/</span> <span class="n">test_data_es</span><span class="p">[</span><span class="s1">&#39;EUR&#39;</span><span class="p">]))</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Imprimir resultados para USD</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejores parámetros para el modelo ES (USD): Alpha: </span><span class="si">{</span><span class="n">best_alpha_usd</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RMSE en Validación: </span><span class="si">{</span><span class="n">best_rmse_usd</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAE en Validación: </span><span class="si">{</span><span class="n">best_mae_usd</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE en Validación: </span><span class="si">{</span><span class="n">best_mape_usd</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RMSE en Prueba: </span><span class="si">{</span><span class="n">rmse_test_usd</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAE en Prueba: </span><span class="si">{</span><span class="n">mae_test_usd</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE en Prueba: </span><span class="si">{</span><span class="n">mape_test_usd</span><span class="si">}</span><span class="s2">%</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="mi">50</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Imprimir resultados para EUR</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejores parámetros para el modelo ES (EUR): Alpha: </span><span class="si">{</span><span class="n">best_alpha_eur</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RMSE en Validación: </span><span class="si">{</span><span class="n">best_rmse_eur</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAE en Validación: </span><span class="si">{</span><span class="n">best_mae_eur</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE en Validación: </span><span class="si">{</span><span class="n">best_mape_eur</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RMSE en Prueba: </span><span class="si">{</span><span class="n">rmse_test_eur</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAE en Prueba: </span><span class="si">{</span><span class="n">mae_test_eur</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE en Prueba: </span><span class="si">{</span><span class="n">mape_test_eur</span><span class="si">}</span><span class="s2">%</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Graficar los resultados con colores diferenciados para USD</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">train_data_es</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">train_data_es</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Datos de Entrenamiento (USD)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">val_data_es</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">val_data_es</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Datos de Validación (USD)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_data_es</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">test_data_es</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Datos de Prueba (USD)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_data_es</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">test_predictions_usd</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predicciones (USD)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Precio del Oro (USD)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Comparación de Valores Reales Vs Predicciones para USD&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">daily_gold_rate_benchmark</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;daily_gold_rate.csv&#39;</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">])</span>
<span class="n">daily_gold_rate_benchmark</span> <span class="o">=</span> <span class="n">daily_gold_rate_benchmark</span><span class="p">[[</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="s1">&#39;USD&#39;</span><span class="p">,</span> <span class="s1">&#39;EUR&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="c1"># Graficar los resultados con colores diferenciados para EUR</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">train_data_es</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">train_data_es</span><span class="p">[</span><span class="s1">&#39;EUR&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Datos de Entrenamiento (EUR)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">val_data_es</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">val_data_es</span><span class="p">[</span><span class="s1">&#39;EUR&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Datos de Validación (EUR)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_data_es</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">test_data_es</span><span class="p">[</span><span class="s1">&#39;EUR&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Datos de Prueba (EUR)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_data_es</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">test_predictions_eur</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predicciones (EUR)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Precio del Oro (EUR)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Comparación de Valores Reales Vs Predicciones para EUR&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimizando USD: 100%|██████████| 10/10 [00:00&lt;00:00, 69.09it/s]
Optimizando EUR: 100%|██████████| 10/10 [00:00&lt;00:00, 7637.12it/s]
Generando Predicciones: 100%|██████████| 1518/1518 [02:59&lt;00:00,  8.47it/s]
Generando Predicciones: 100%|██████████| 1518/1518 [03:00&lt;00:00,  8.43it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--------------------------------------------------

Mejores parámetros para el modelo ES (USD): Alpha: 0.01
RMSE en Validación: 358.21612462706935
MAE en Validación: 324.2432766436425
MAPE en Validación: 26.217322069517714%
RMSE en Prueba: 256.41940160960286
MAE en Prueba: 230.963874256096
MAPE en Prueba: 14.954508027812356%


--------------------------------------------------

Mejores parámetros para el modelo ES (EUR): Alpha: 0.01
RMSE en Validación: 167.93183265705997
MAE en Validación: 144.8982944999768
MAPE en Validación: 14.116607823952092%
RMSE en Prueba: 358.23351333606917
MAE en Prueba: 311.5950077468152
MAPE en Prueba: 19.90202057355063%
</pre></div>
</div>
<img alt="_images/c1b9351bc2ae461e0dc605f53894cdc41469fd370c8f5a70681b65548cb5d7bc.png" src="_images/c1b9351bc2ae461e0dc605f53894cdc41469fd370c8f5a70681b65548cb5d7bc.png" />
<img alt="_images/6bc83805dfd6eb58d091ea5cb762cd091b0274da41c98a570feb96cc56f1e011.png" src="_images/6bc83805dfd6eb58d091ea5cb762cd091b0274da41c98a570feb96cc56f1e011.png" />
</div>
</div>
</section>
<section id="interpretacion-de-los-resultados-del-modelo-de-suavizado-exponencial-es-usando-ventanas-deslizantes">
<h2>Interpretación de los Resultados del Modelo de Suavizado Exponencial (ES) Usando Ventanas Deslizantes<a class="headerlink" href="#interpretacion-de-los-resultados-del-modelo-de-suavizado-exponencial-es-usando-ventanas-deslizantes" title="Link to this heading">#</a></h2>
<p>Después de aplicar el enfoque de <strong>ventanas deslizantes</strong> al modelo de <strong>Suavizado Exponencial (ES)</strong> para intentar mejorar su precisión al predecir los precios del oro en <strong>USD</strong> y <strong>EUR</strong>, se obtuvieron los siguientes resultados:</p>
</section>
<section id="resultados-del-modelo-ventanas-deslizantes">
<h2>Resultados del Modelo (Ventanas Deslizantes)<a class="headerlink" href="#resultados-del-modelo-ventanas-deslizantes" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>USD</strong>:</p>
<ul>
<li><p><strong>Alpha</strong>: 0.01</p></li>
<li><p><strong>RMSE en Validación</strong>: 358.22</p></li>
<li><p><strong>MAE en Validación</strong>: 324.24</p></li>
<li><p><strong>MAPE en Validación</strong>: 26.22%</p></li>
<li><p><strong>RMSE en Prueba</strong>: 256.42</p></li>
<li><p><strong>MAE en Prueba</strong>: 230.96</p></li>
<li><p><strong>MAPE en Prueba</strong>: 14.95%</p></li>
</ul>
</li>
<li><p><strong>EUR</strong>:</p>
<ul>
<li><p><strong>Alpha</strong>: 0.01</p></li>
<li><p><strong>RMSE en Validación</strong>: 167.93</p></li>
<li><p><strong>MAE en Validación</strong>: 144.90</p></li>
<li><p><strong>MAPE en Validación</strong>: 14.12%</p></li>
<li><p><strong>RMSE en Prueba</strong>: 358.23</p></li>
<li><p><strong>MAE en Prueba</strong>: 311.60</p></li>
<li><p><strong>MAPE en Prueba</strong>: 19.90%</p></li>
</ul>
</li>
</ul>
</section>
<section id="id1">
<h2>Interpretación de los Resultados<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>USD</strong>:</p>
<ul>
<li><p>El <strong>RMSE</strong> y <strong>MAE</strong> en el conjunto de validación son considerablemente más altos que en el conjunto de prueba, lo que sugiere que el modelo pudo haber ajustado mejor los datos recientes. El valor de <strong>MAPE</strong> en el conjunto de prueba, aunque menor que en validación, sigue siendo alto (14.95%), lo que indica que el modelo aún no captura con precisión las fluctuaciones recientes del mercado.</p></li>
</ul>
</li>
<li><p><strong>EUR</strong>:</p>
<ul>
<li><p>En los resultados de <strong>EUR</strong> se observa un <strong>MAPE</strong> más alto en prueba que en validación, lo que sugiere que el modelo no generaliza adecuadamente para datos no vistos durante el entrenamiento. Las predicciones también muestran una tendencia plana, lo que indica que el modelo no está capturando correctamente las tendencias del mercado.</p></li>
</ul>
</li>
</ul>
</section>
<section id="comparacion-con-el-modelo-anterior-sin-ventanas-deslizantes">
<h2>Comparación con el Modelo Anterior (Sin Ventanas Deslizantes)<a class="headerlink" href="#comparacion-con-el-modelo-anterior-sin-ventanas-deslizantes" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Para <strong>USD</strong>, el enfoque de ventanas deslizantes mejoró significativamente el <strong>RMSE</strong> y <strong>MAE</strong>, lo que indica que el modelo se ajusta mejor a las tendencias recientes. Sin embargo, el <strong>MAPE</strong> sigue siendo alto, mostrando que el modelo aún no es capaz de capturar las fluctuaciones del mercado.</p></li>
<li><p>En <strong>EUR</strong>, aunque el <strong>RMSE</strong> y <strong>MAE</strong> son mejores con el enfoque de ventanas deslizantes, el <strong>MAPE</strong> sigue siendo elevado, lo que refleja que el modelo no logra capturar detalladamente las fluctuaciones de los precios en esta moneda.</p></li>
</ul>
</section>
<section id="indicios-de-sobreajuste">
<h2>Indicios de Sobreajuste<a class="headerlink" href="#indicios-de-sobreajuste" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>En el caso de <strong>USD</strong>, el <strong>MAPE</strong> en el conjunto de prueba (14.95%) es menor que en el conjunto de validación (26.22%), lo que sugiere que <strong>no hay sobreajuste</strong>, ya que el modelo se está desempeñando mejor con datos que no ha visto antes. Esto indica que el modelo ha generalizado bien a los datos de prueba.</p></li>
<li><p>En el caso de <strong>EUR</strong>, el <strong>MAPE</strong> en el conjunto de prueba (19.90%) es mayor que en el conjunto de validación (14.12%), lo que podría indicar que el modelo está sufriendo <strong>sobreajuste</strong>, ya que no está generalizando tan bien a los datos de prueba y tiene un peor rendimiento en comparación con el conjunto de validación.</p></li>
</ul>
</section>
<section id="analisis-de-la-tendencia-grafica">
<h2>Análisis de la Tendencia Gráfica<a class="headerlink" href="#analisis-de-la-tendencia-grafica" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Las gráficas muestran una <strong>predicción plana</strong>, lo que sugiere que el modelo no está capturando las tendencias recientes de los precios del oro. A pesar de la optimización de los parámetros, el modelo parece seguir dependiendo demasiado de los valores históricos.</p></li>
</ul>
</section>
<section id="conclusion-general-sobre-el-modelo-de-suavizado-exponencial-es">
<h2>Conclusión General sobre el Modelo de Suavizado Exponencial (ES)<a class="headerlink" href="#conclusion-general-sobre-el-modelo-de-suavizado-exponencial-es" title="Link to this heading">#</a></h2>
<p>El modelo de <strong>Suavizado Exponencial (ES)</strong>, tanto en su versión básica como con el enfoque de <strong>ventanas deslizantes</strong>, presenta limitaciones para capturar las fluctuaciones y la volatilidad en los precios del oro, tanto en <strong>USD</strong> como en <strong>EUR</strong>. Si bien el enfoque de ventanas deslizantes ha mostrado mejoras en <strong>RMSE</strong> y <strong>MAE</strong>, el modelo sigue teniendo dificultades para adaptarse a las tendencias recientes, especialmente en el caso de <strong>MAPE</strong>, que sigue siendo alto en ambos enfoques.</p>
<section id="consideraciones-finales-sobre-el-modelo-es">
<h3>Consideraciones Finales sobre el Modelo ES:<a class="headerlink" href="#consideraciones-finales-sobre-el-modelo-es" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>El modelo <strong>ES</strong> es adecuado para series temporales con patrones estables y no demasiado volátiles, pero no parece ser adecuado para este caso, ya que estamos hablando de datos moderadamente volátiles y con mucho ruido.</p></li>
<li><p>La falta de una tendencia clara en los datos de predicción sugiere que es necesario probar otros modelos que puedan capturar mejor las características de la serie temporal.</p></li>
</ul>
<p>En resumen, el enfoque de <strong>Suavizado Exponencial</strong> ha mostrado algunos resultados positivos en la predicción de tendencias generales, pero no es el modelo más adecuado para capturar las fluctuaciones a corto plazo en los precios del oro.</p>
</section>
</section>
<section id="implementacion-del-modelo-holt-winters">
<h2>Implementacion del Modelo Holt-Winters<a class="headerlink" href="#implementacion-del-modelo-holt-winters" title="Link to this heading">#</a></h2>
<p>A continuación, se implementará el modelo de <strong>Holt-Winters</strong> para los precios del oro en <strong>USD</strong> y <strong>EUR</strong>, considerando los componentes de <strong>tendencia</strong>, pero no <strong>estacionalidad</strong>. Dado que los precios del oro no presentan un comportamiento estacional claro, el único patrón identificado se caracteriza por la subida de los precios durante crisis económicas entre los años estudiados. Esto se debe a que el precio del oro mostró un claro comportamiento de crecimiento en esos periodos. El modelo será evaluado en las mismas condiciones que el de suavización exponencial simple, además de evaluar la capacidad para capturar las fluctuaciones más realistas en el comportamiento en comparación con el modelo <strong>ES</strong>.</p>
</section>
<section id="parametros">
<h2>Parámetros<a class="headerlink" href="#parametros" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Se decidió usar <code class="docutils literal notranslate"><span class="pre">trend='mul'</span></code> dentro del modelo debido a la <strong>tendencia positiva clara</strong> encontrada en el Análisis Exploratorio de Datos.</p></li>
<li><p>El modelo usará <code class="docutils literal notranslate"><span class="pre">seasonal=None</span></code>, dado que en el EDA la <strong>descomposición STL</strong> no mostró ningún comportamiento estacional claro.</p></li>
<li><p>Para el modelo se optimizarán los valores de los parámetros <strong>Alpha</strong> y <strong>Beta</strong> utilizando la técnica de <strong>Grid search</strong>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Establecer &#39;Date&#39; como índice para el análisis de HS</span>
<span class="n">daily_gold_rate_hs</span> <span class="o">=</span> <span class="n">daily_gold_rate_benchmark</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">daily_gold_rate_hs</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Establecer la frecuencia del índice como diaria</span>
<span class="n">daily_gold_rate_hs</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">daily_gold_rate_hs</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">daily_gold_rate_hs</span> <span class="o">=</span> <span class="n">daily_gold_rate_hs</span><span class="o">.</span><span class="n">asfreq</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">)</span>  <span class="c1"># Días hábiles</span>

<span class="c1"># División del conjunto de datos en entrenamiento y prueba</span>
<span class="n">train_size_hs</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">daily_gold_rate_hs</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
<span class="n">train_data_hs</span> <span class="o">=</span> <span class="n">daily_gold_rate_hs</span><span class="p">[:</span><span class="n">train_size_hs</span><span class="p">]</span>
<span class="n">test_data_hs</span> <span class="o">=</span> <span class="n">daily_gold_rate_hs</span><span class="p">[</span><span class="n">train_size_hs</span><span class="p">:]</span>

<span class="c1"># Definir los valores posibles de los parámetros de suavizado</span>
<span class="n">alpha_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>  <span class="c1"># Valores posibles para alpha</span>
<span class="n">beta_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>   <span class="c1"># Valores posibles para beta</span>

<span class="c1"># Función para optimizar alpha y beta para una serie temporal dada</span>
<span class="k">def</span> <span class="nf">optimizar_parametros</span><span class="p">(</span><span class="n">currency_data</span><span class="p">,</span> <span class="n">test_data</span><span class="p">):</span>
    <span class="n">best_rmse</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
    <span class="n">best_alpha</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">best_beta</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">best_model</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">best_mae</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">best_mape</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">alpha_values</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">beta</span> <span class="ow">in</span> <span class="n">beta_values</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Modelo con tendencia multiplicativa</span>
                <span class="n">model</span> <span class="o">=</span> <span class="n">ExponentialSmoothing</span><span class="p">(</span><span class="n">currency_data</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="s1">&#39;mul&#39;</span><span class="p">,</span> <span class="n">seasonal</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">smoothing_level</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">smoothing_trend</span><span class="o">=</span><span class="n">beta</span><span class="p">)</span>
                <span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test_data</span><span class="p">))</span>
                
                <span class="c1"># Calcular métricas de error</span>
                <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">test_data</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
                <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">test_data</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
                <span class="n">mape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">test_data</span> <span class="o">-</span> <span class="n">predictions</span><span class="p">)</span> <span class="o">/</span> <span class="n">test_data</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>

                <span class="k">if</span> <span class="n">rmse</span> <span class="o">&lt;</span> <span class="n">best_rmse</span><span class="p">:</span>
                    <span class="n">best_rmse</span> <span class="o">=</span> <span class="n">rmse</span>
                    <span class="n">best_alpha</span> <span class="o">=</span> <span class="n">alpha</span>
                    <span class="n">best_beta</span> <span class="o">=</span> <span class="n">beta</span>
                    <span class="n">best_model</span> <span class="o">=</span> <span class="n">model</span>
                    <span class="n">best_mae</span> <span class="o">=</span> <span class="n">mae</span>
                    <span class="n">best_mape</span> <span class="o">=</span> <span class="n">mape</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error en alpha=</span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s2">, beta=</span><span class="si">{</span><span class="n">beta</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">continue</span>

    <span class="k">return</span> <span class="n">best_alpha</span><span class="p">,</span> <span class="n">best_beta</span><span class="p">,</span> <span class="n">best_rmse</span><span class="p">,</span> <span class="n">best_mae</span><span class="p">,</span> <span class="n">best_mape</span><span class="p">,</span> <span class="n">best_model</span>

<span class="c1"># Optimización de alpha y beta para USD y EUR</span>
<span class="n">best_alpha_usd</span><span class="p">,</span> <span class="n">best_beta_usd</span><span class="p">,</span> <span class="n">best_rmse_usd</span><span class="p">,</span> <span class="n">best_mae_usd</span><span class="p">,</span> <span class="n">best_mape_usd</span><span class="p">,</span> <span class="n">best_model_usd</span> <span class="o">=</span> <span class="n">optimizar_parametros</span><span class="p">(</span><span class="n">train_data_hs</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">],</span> <span class="n">test_data_hs</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">])</span>
<span class="n">best_alpha_eur</span><span class="p">,</span> <span class="n">best_beta_eur</span><span class="p">,</span> <span class="n">best_rmse_eur</span><span class="p">,</span> <span class="n">best_mae_eur</span><span class="p">,</span> <span class="n">best_mape_eur</span><span class="p">,</span> <span class="n">best_model_eur</span> <span class="o">=</span> <span class="n">optimizar_parametros</span><span class="p">(</span><span class="n">train_data_hs</span><span class="p">[</span><span class="s1">&#39;EUR&#39;</span><span class="p">],</span> <span class="n">test_data_hs</span><span class="p">[</span><span class="s1">&#39;EUR&#39;</span><span class="p">])</span>

<span class="c1"># Imprimir resultados para USD</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejores parámetros para el modelo H-W (USD): Alpha: </span><span class="si">{</span><span class="n">best_alpha_usd</span><span class="si">}</span><span class="s2">, Beta: </span><span class="si">{</span><span class="n">best_beta_usd</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RMSE: </span><span class="si">{</span><span class="n">best_rmse_usd</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAE: </span><span class="si">{</span><span class="n">best_mae_usd</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE: </span><span class="si">{</span><span class="n">best_mape_usd</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

<span class="c1"># Imprimir resultados para EUR</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Mejores parámetros para el modelo H-W (EUR): Alpha: </span><span class="si">{</span><span class="n">best_alpha_eur</span><span class="si">}</span><span class="s2">, Beta: </span><span class="si">{</span><span class="n">best_beta_eur</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RMSE: </span><span class="si">{</span><span class="n">best_rmse_eur</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAE: </span><span class="si">{</span><span class="n">best_mae_eur</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE: </span><span class="si">{</span><span class="n">best_mape_eur</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

<span class="c1"># Graficar Comparativa de Valores Reales, Entrenamiento vs. Predichos (USD)</span>
<span class="n">predictions_usd</span> <span class="o">=</span> <span class="n">best_model_usd</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test_data_hs</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="c1"># Graficar los datos de entrenamiento</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">daily_gold_rate_hs</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">train_data_hs</span><span class="p">)],</span> <span class="n">train_data_hs</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Datos de Entrenamiento (USD)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">)</span>
<span class="c1"># Graficar los valores reales (datos de prueba)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_data_hs</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">test_data_hs</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Valores Reales (USD)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="c1"># Graficar los valores predichos</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_data_hs</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">predictions_usd</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Valores Predichos (USD)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Precio del Oro (USD)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Comparación de Valores Reales, Entrenamiento vs. Predichos para USD&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Graficar Comparativa de Valores Reales, Entrenamiento vs. Predichos (EUR)</span>
<span class="n">predictions_eur</span> <span class="o">=</span> <span class="n">best_model_eur</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test_data_hs</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="c1"># Graficar los datos de entrenamiento</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">daily_gold_rate_hs</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">train_data_hs</span><span class="p">)],</span> <span class="n">train_data_hs</span><span class="p">[</span><span class="s1">&#39;EUR&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Datos de Entrenamiento (EUR)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">)</span>
<span class="c1"># Graficar los valores reales (datos de prueba)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_data_hs</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">test_data_hs</span><span class="p">[</span><span class="s1">&#39;EUR&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Valores Reales (EUR)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="c1"># Graficar los valores predichos</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_data_hs</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">predictions_eur</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Valores Predichos (EUR)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Precio del Oro (EUR)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Comparación de Valores Reales, Entrenamiento vs. Predichos para EUR&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejores parámetros para el modelo H-W (USD): Alpha: 0.23, Beta: 0.12
RMSE: 131.86289910386884
MAE: 104.01542736896363
MAPE: 6.691415400748299%

Mejores parámetros para el modelo H-W (EUR): Alpha: 0.12, Beta: 0.12
RMSE: 106.39036767472794
MAE: 86.4415098401811
MAPE: 6.496584479747685%
</pre></div>
</div>
<img alt="_images/0111bacab28cef50f22ba82573f0754dcf5450d0fa9b9af89f6cf2a6e462941e.png" src="_images/0111bacab28cef50f22ba82573f0754dcf5450d0fa9b9af89f6cf2a6e462941e.png" />
<img alt="_images/952a10949bc87d862e64b42adab809c2cf84f1f2fa1c48ce78c9502a74614ebf.png" src="_images/952a10949bc87d862e64b42adab809c2cf84f1f2fa1c48ce78c9502a74614ebf.png" />
</div>
</div>
</section>
</section>
<section id="interpretacion-de-los-resultados-del-modelo-holt-winters-hs-para-usd-y-eur">
<h1>Interpretación de los Resultados del Modelo Holt-Winters (HS) para USD y EUR<a class="headerlink" href="#interpretacion-de-los-resultados-del-modelo-holt-winters-hs-para-usd-y-eur" title="Link to this heading">#</a></h1>
<p>El <strong>modelo de Holt-Winters</strong> después de ser optimizado para la predicción de los precios del oro en <strong>USD</strong> y <strong>EUR</strong> utilizando <strong>Grid search</strong> obtuvo los siguientes resultados:</p>
<section id="resultados-del-modelo-holt-winters-para-usd-y-eur">
<h2>Resultados del Modelo Holt-Winters para USD y EUR<a class="headerlink" href="#resultados-del-modelo-holt-winters-para-usd-y-eur" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>USD</strong>:</p>
<ul>
<li><p><strong>Alpha</strong>: 0.23</p></li>
<li><p><strong>Beta</strong>: 0.12</p></li>
<li><p><strong>RMSE</strong>: 131.86</p></li>
<li><p><strong>MAE</strong>: 104.02</p></li>
<li><p><strong>MAPE</strong>: 6.69%</p></li>
</ul>
</li>
<li><p><strong>EUR</strong>:</p>
<ul>
<li><p><strong>Alpha</strong>: 0.12</p></li>
<li><p><strong>Beta</strong>: 0.12</p></li>
<li><p><strong>RMSE</strong>: 106.39</p></li>
<li><p><strong>MAE</strong>: 86.44</p></li>
<li><p><strong>MAPE</strong>: 6.50%</p></li>
</ul>
</li>
</ul>
</section>
<section id="interpretacion-de-los-resultados-para-usd-y-eur">
<h2>Interpretación de los Resultados para USD y EUR<a class="headerlink" href="#interpretacion-de-los-resultados-para-usd-y-eur" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Alpha y Beta</strong>:</p>
<ul>
<li><p>En <strong>USD</strong>, el valor de <strong>Alpha</strong> es ligeramente mayor (0.23) que en <strong>EUR</strong> (0.12), lo que indica que el modelo para <strong>USD</strong> otorga más peso a las observaciones recientes, permitiendo una mayor respuesta a los cambios recientes en la tendencia. En <strong>EUR</strong>, el menor valor de <strong>Alpha</strong> sugiere que el modelo es más conservador, reflejando una menor influencia de las observaciones recientes.</p></li>
<li><p>Ambos modelos comparten un valor bajo de <strong>Beta</strong> (0.12), lo que refleja que los cambios en la tendencia no son abruptos, capturando una <strong>tendencia más suave</strong> y estable en el tiempo para ambas divisas.</p></li>
</ul>
</li>
<li><p><strong>RMSE y MAE</strong>:</p>
<ul>
<li><p>El modelo tiene un <strong>mejor rendimiento en EUR</strong>, con <strong>RMSE</strong> y <strong>MAE</strong> menores en comparación con <strong>USD</strong>. Esto sugiere una mejor adaptación a las tendencias de los precios del oro en <strong>EUR</strong> y puede indicar una menor volatilidad en esta divisa.</p></li>
</ul>
</li>
<li><p><strong>MAPE</strong>:</p>
<ul>
<li><p>Los valores de <strong>MAPE</strong> son bajos en ambos casos (6.69% para <strong>USD</strong> y 6.50% para <strong>EUR</strong>), lo que indica que el modelo tiene un buen rendimiento general en ambas divisas, con errores relativos aceptables que permiten capturar la <strong>tendencia general</strong> del mercado con precisión.</p></li>
</ul>
</li>
</ul>
</section>
<section id="captura-de-la-tendencia">
<h2>Captura de la Tendencia<a class="headerlink" href="#captura-de-la-tendencia" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Captura de la Tendencia General</strong>: El modelo <strong>Holt-Winters</strong> ha capturado la <strong>tendencia positiva general</strong> de los precios del oro tanto en <strong>USD</strong> como en <strong>EUR</strong> de manera efectiva. La <strong>línea de predicción</strong> sigue de cerca la trayectoria de crecimiento observada en ambas divisas.</p></li>
<li><p><strong>Comparación con el Modelo ES</strong>: A diferencia del modelo <strong>Suavizado Exponencial (ES)</strong>, que predecía una línea plana, el modelo <strong>Holt-Winters</strong> sigue con mayor precisión la tendencia creciente. Esto es evidente en ambas divisas, donde la <strong>línea de predicción</strong> refleja mejor los incrementos a largo plazo.</p></li>
<li><p><strong>Limitaciones en la Volatilidad</strong>: Aunque el modelo captura correctamente la <strong>tendencia general</strong> en ambas divisas, sigue teniendo dificultades para reflejar las <strong>fluctuaciones de corto plazo</strong> y la <strong>volatilidad</strong> del mercado. Las fluctuaciones no son representadas con exactitud, lo que indica que el modelo suaviza demasiado los movimientos del mercado.</p></li>
</ul>
</section>
<section id="conclusiones-generales-sobre-el-modelo-holt-winters-h-w">
<h2>Conclusiónes Generales sobre el Modelo Holt-Winters (H-W)<a class="headerlink" href="#conclusiones-generales-sobre-el-modelo-holt-winters-h-w" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Mejora significativa respecto al Modelo ES</strong>: El modelo <strong>Holt-Winters</strong> ha demostrado una mejora notable en la captura de la <strong>tendencia general</strong> del mercado en ambas divisas, con <strong>menores errores</strong> y un ajuste más preciso que el modelo <strong>ES</strong>.</p></li>
<li><p><strong>Mejor ajuste en EUR</strong>: Aunque el modelo funciona bien en ambas divisas, los <strong>errores</strong> en <strong>EUR</strong> son menores, lo que muestra las diferencias en la volatilidad del mercado entre <strong>USD</strong> y <strong>EUR</strong>.</p></li>
<li><p><strong>Volatilidad</strong>: A pesar de la mejora en la captura de la tendencia, el modelo <strong>no refleja las fluctuaciones a corto plazo</strong>, lo que podría requerir ajustes adicionales o el uso de modelos que sean más sensibles a la <strong>volatilidad</strong> y los cambios abruptos.</p></li>
</ul>
<p>El modelo <strong>Holt-Winters</strong> ha mejorado significativamente el rendimiento predictivo en comparacion al modelo <strong>ES</strong>, capturando correctamente la tendencia general en ambos mercados. Sin embargo, aún se presentan desafíos en la predicción de la volatilidad de corto plazo.</p>
</section>
</section>
<section id="evaluacion-de-potenciales-periodos-estacionales-para-el-modelo-holt-winters">
<h1>Evaluación de Potenciales Periodos Estacionales para el Modelo Holt-Winters<a class="headerlink" href="#evaluacion-de-potenciales-periodos-estacionales-para-el-modelo-holt-winters" title="Link to this heading">#</a></h1>
<p>Aunque el análisis exploratorio de datos (EDA) no mostró evidencia clara de estacionalidad en los precios del oro, se decidió probar varios <strong>periodos estacionales</strong> como parte de un <strong>análisis</strong> exhaustivo con el objetivo de verificar si existía algún <strong>patrón estacional</strong> que <strong>no</strong> hubiera sido identificado previamente.</p>
<p>Con el objetivo de confirmar la existencia de algún <strong>patrón estacional</strong>, se tomaron los siguientes pasos:</p>
<ul class="simple">
<li><p>Se seleccionaron <strong>periodos estacionales</strong> posibles, abarcando desde una semana a 8 años, para explorar posibles ciclos no identificados en el análisis inicial.</p></li>
<li><p>Se utilizo tanto <strong>tendencia aditiva</strong> como <strong>tendencia multiplicativa</strong> en cada combinación de parámetros.</p></li>
<li><p>Los modelos de Holt-Winters tuvieron sus componentes optimizados y se calcularon las métricas de error para evaluar el rendimiento de cada configuración.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importar las librerías necesarias</span>
<span class="kn">from</span> <span class="nn">joblib</span> <span class="kn">import</span> <span class="n">Parallel</span><span class="p">,</span> <span class="n">delayed</span><span class="p">,</span> <span class="n">parallel_backend</span>
<span class="kn">import</span> <span class="nn">logging</span>

<span class="n">logging</span><span class="o">.</span><span class="n">captureWarnings</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Establecer &#39;Date&#39; como índice para el análisis de ES</span>
<span class="n">daily_gold_rate_test</span> <span class="o">=</span> <span class="n">daily_gold_rate_benchmark</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">daily_gold_rate_test</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Establecer la frecuencia del índice como diaria</span>
<span class="n">daily_gold_rate_test</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">daily_gold_rate_test</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">daily_gold_rate_test</span> <span class="o">=</span> <span class="n">daily_gold_rate_test</span><span class="o">.</span><span class="n">asfreq</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">)</span>  <span class="c1"># Días hábiles</span>

<span class="c1"># División del conjunto de datos en entrenamiento (80%) y prueba (20%)</span>
<span class="n">train_size_test</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">daily_gold_rate_test</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
<span class="n">train_data_test</span> <span class="o">=</span> <span class="n">daily_gold_rate_test</span><span class="p">[:</span><span class="n">train_size_test</span><span class="p">]</span>
<span class="n">test_data_test</span> <span class="o">=</span> <span class="n">daily_gold_rate_test</span><span class="p">[</span><span class="n">train_size_test</span><span class="p">:]</span>

<span class="c1"># Definir los valores posibles de seasonal_periods, añadiendo más opciones intermedias</span>
<span class="n">seasonal_periods_values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">182</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">270</span><span class="p">,</span> <span class="mi">365</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">700</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1500</span><span class="p">,</span> <span class="mi">2080</span><span class="p">,</span> <span class="mi">3000</span><span class="p">]</span>
<span class="n">trend_options</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="s1">&#39;mul&#39;</span><span class="p">]</span>  
<span class="n">seasonal_option</span> <span class="o">=</span> <span class="s1">&#39;add&#39;</span> 
<span class="c1"># Función para ajustar el modelo y calcular las métricas de error</span>
<span class="k">def</span> <span class="nf">optimizar_holt_winters</span><span class="p">(</span><span class="n">trend_option</span><span class="p">,</span> <span class="n">period</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Ajuste del modelo Holt-Winters</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">ExponentialSmoothing</span><span class="p">(</span><span class="n">train_data_test</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">],</span> <span class="n">trend</span><span class="o">=</span><span class="n">trend_option</span><span class="p">,</span> <span class="n">seasonal</span><span class="o">=</span><span class="n">seasonal_option</span><span class="p">,</span> <span class="n">seasonal_periods</span><span class="o">=</span><span class="n">period</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test_data_test</span><span class="p">))</span>

        <span class="c1"># Obtener los valores de alpha, beta, gamma</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;smoothing_level&#39;</span><span class="p">]</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;smoothing_trend&#39;</span><span class="p">]</span>
        <span class="n">gamma</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;smoothing_seasonal&#39;</span><span class="p">]</span>

        <span class="c1"># Calcular métricas de error</span>
        <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">test_data_test</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">],</span> <span class="n">predictions</span><span class="p">))</span>
        <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">test_data_test</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">],</span> <span class="n">predictions</span><span class="p">)</span>
        <span class="n">mape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">test_data_test</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">predictions</span><span class="p">)</span> <span class="o">/</span> <span class="n">test_data_test</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">]))</span> <span class="o">*</span> <span class="mi">100</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;trend&#39;</span><span class="p">:</span> <span class="n">trend_option</span><span class="p">,</span>
            <span class="s1">&#39;seasonal_period&#39;</span><span class="p">:</span> <span class="n">period</span><span class="p">,</span>
            <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="n">alpha</span><span class="p">,</span>
            <span class="s1">&#39;beta&#39;</span><span class="p">:</span> <span class="n">beta</span><span class="p">,</span>
            <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="n">gamma</span><span class="p">,</span>
            <span class="s1">&#39;rmse&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
            <span class="s1">&#39;mae&#39;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
            <span class="s1">&#39;mape&#39;</span><span class="p">:</span> <span class="n">mape</span>
        <span class="p">}</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

<span class="c1"># Paralelización usando joblib con parallel_backend</span>
<span class="k">with</span> <span class="n">parallel_backend</span><span class="p">(</span><span class="s1">&#39;threading&#39;</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">14</span><span class="p">):</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">()(</span><span class="n">delayed</span><span class="p">(</span><span class="n">optimizar_holt_winters</span><span class="p">)(</span><span class="n">trend_option</span><span class="p">,</span> <span class="n">period</span><span class="p">)</span> 
                         <span class="k">for</span> <span class="n">trend_option</span> <span class="ow">in</span> <span class="n">trend_options</span> 
                         <span class="k">for</span> <span class="n">period</span> <span class="ow">in</span> <span class="n">seasonal_periods_values</span><span class="p">)</span>

<span class="c1"># Filtrar los resultados válidos</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">result</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span> <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>

<span class="c1"># Imprimir todos los resultados</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Resultados para diferentes combinaciones de parámetros seasonal_option = &#39;add&#39;:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Trend: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;trend&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, Periodo estacional: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;seasonal_period&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, Alpha: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, Beta: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;beta&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, Gamma: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;gamma&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> - RMSE: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;rmse&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, MAE: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;mae&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, MAPE: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;mape&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

<span class="c1"># Encontrar y mostrar el mejor resultado</span>
<span class="n">mejor_resultado</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;rmse&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Mejor combinación de parámetros: </span><span class="si">{</span><span class="n">mejor_resultado</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resultados para diferentes combinaciones de parámetros seasonal_option = &#39;add&#39;:
Trend: add, Periodo estacional: 7, Alpha: 0.9935119979188447, Beta: 0.0017604623399647917, Gamma: 0.00646891201284708 - RMSE: 930.403632524506, MAE: 806.8108325692517, MAPE: 48.394289654869276%
Trend: add, Periodo estacional: 15, Alpha: 0.9565429751698167, Beta: 0.004992755046610034, Gamma: 0.008777389669000291 - RMSE: 1165.1681127657987, MAE: 1011.6618711613305, MAPE: 60.78763694064481%
Trend: add, Periodo estacional: 31, Alpha: 0.9948562380175525, Beta: 0.0035999963999705413, Gamma: 0.00510163275809889 - RMSE: 1148.789512983282, MAE: 998.0430794341268, MAPE: 59.98066345217268%
Trend: add, Periodo estacional: 45, Alpha: 0.9585934000949805, Beta: 0.00026252213826226595, Gamma: 0.01641740715972476 - RMSE: 447.35267812866243, MAE: 381.5147312386008, MAPE: 22.693383280959438%
Trend: add, Periodo estacional: 60, Alpha: 0.9508953772178569, Beta: 0.007134287883030872, Gamma: 0.009841477737554716 - RMSE: 1171.6406989962895, MAE: 1016.9406219030521, MAPE: 61.09766609260119%
Trend: add, Periodo estacional: 90, Alpha: 0.9530998122266463, Beta: 0.007317962072922013, Gamma: 0.018812290212110398 - RMSE: 1231.3365607413489, MAE: 1070.4507502317083, MAPE: 64.37404707208778%
Trend: add, Periodo estacional: 120, Alpha: 0.957881473719098, Beta: 0.011425084953036986, Gamma: 0.024518509465052116 - RMSE: 1190.7049338266193, MAE: 1033.2211538186777, MAPE: 62.07399108130113%
Trend: add, Periodo estacional: 150, Alpha: 0.9523044962574043, Beta: 0.001986371436555271, Gamma: 0.03740984575626207 - RMSE: 990.9046142390757, MAE: 860.3725349550006, MAPE: 51.65539865877228%
Trend: add, Periodo estacional: 182, Alpha: 0.9525058307012676, Beta: 0.008211289510230261, Gamma: 0.027668789671332784 - RMSE: 1242.40374506193, MAE: 1080.0847430381882, MAPE: 64.95766377598463%
Trend: add, Periodo estacional: 200, Alpha: 0.960099990944203, Beta: 0.0073150088997350916, Gamma: 0.023921547466312875 - RMSE: 1177.1293095014105, MAE: 1022.3759951059974, MAPE: 61.44445060588698%
Trend: add, Periodo estacional: 250, Alpha: 0.9548870763454784, Beta: 0.010557585432611592, Gamma: 0.031029874054066937 - RMSE: 1114.0711016564892, MAE: 964.9641128851794, MAPE: 57.90881308464534%
Trend: add, Periodo estacional: 270, Alpha: 0.9600024416586879, Beta: 0.0001207061161744817, Gamma: 0.03207963869314063 - RMSE: 449.61328046368527, MAE: 382.66571137342, MAPE: 22.74088005334729%
Trend: add, Periodo estacional: 365, Alpha: 0.9406450254142686, Beta: 0.018717816093619263, Gamma: 0.04655052033322526 - RMSE: 1223.3045149109234, MAE: 1062.5646547540139, MAPE: 63.87520058187231%
Trend: add, Periodo estacional: 500, Alpha: 0.9513693089974586, Beta: 0.016238807634402653, Gamma: 0.038629873201664916 - RMSE: 996.4570049480582, MAE: 861.2188627520671, MAPE: 51.60084672406623%
Trend: add, Periodo estacional: 700, Alpha: 0.9814400116784057, Beta: 0.009005850625664296, Gamma: 0.01762691777559433 - RMSE: 1049.4450595994972, MAE: 907.9646663340957, MAPE: 54.44621864505432%
Trend: add, Periodo estacional: 800, Alpha: 0.9690707754313383, Beta: 0.05639503031107413, Gamma: 0.000581561097100287 - RMSE: 611.2498746757454, MAE: 528.4784602936473, MAPE: 31.608558168739915%
Trend: add, Periodo estacional: 1000, Alpha: 0.9950967047952295, Beta: 0.019344257401677434, Gamma: 0.004902690817064511 - RMSE: 976.9212923473011, MAE: 845.6982733604526, MAPE: 50.69096034000299%
Trend: add, Periodo estacional: 1500, Alpha: 0.9703270136922769, Beta: 0.05348956798295145, Gamma: 0.0005723658714120696 - RMSE: 611.6219871542861, MAE: 517.2633122679864, MAPE: 30.634827388423574%
Trend: add, Periodo estacional: 2080, Alpha: 0.9416172599115029, Beta: 0.046755589686476466, Gamma: 0.05175022316430785 - RMSE: 994.3942627608753, MAE: 862.6788410382086, MAPE: 51.782777008779476%
Trend: add, Periodo estacional: 3000, Alpha: 0.9232179967289319, Beta: 0.05739600317015375, Gamma: 0.07351802523425761 - RMSE: 142.8362837813294, MAE: 118.05027106061966, MAPE: 7.966362440387403%
Trend: mul, Periodo estacional: 7, Alpha: 0.995, Beta: 0.0001, Gamma: 0.0050000000000000044 - RMSE: 359.37126243348945, MAE: 275.3809751649402, MAPE: 16.81592664320318%
Trend: mul, Periodo estacional: 15, Alpha: 0.9584129209039637, Beta: 0.003627920984977702, Gamma: 0.008032299772753566 - RMSE: 909.1173030672182, MAE: 797.8437603235191, MAPE: 48.104937867917656%
Trend: mul, Periodo estacional: 31, Alpha: 0.9950120894669072, Beta: 0.0025100308800604745, Gamma: 0.004984552614134859 - RMSE: 860.8117678466745, MAE: 753.601395338503, MAPE: 45.375407771201445%
Trend: mul, Periodo estacional: 45, Alpha: 0.9596428564961633, Beta: 0.00010000032297629316, Gamma: 0.01614285741785244 - RMSE: 443.98646672548637, MAE: 379.43563687425245, MAPE: 22.593019858771207%
Trend: mul, Periodo estacional: 60, Alpha: 0.9596428571428571, Beta: 0.0001, Gamma: 0.008071428571428573 - RMSE: 805.7552728175967, MAE: 627.707065546197, MAPE: 37.341648816328785%
Trend: mul, Periodo estacional: 90, Alpha: 0.9596428571428571, Beta: 0.0001, Gamma: 0.016142857142857146 - RMSE: 213.07229237596496, MAE: 163.36088535508, MAPE: 10.210322274113825%
Trend: mul, Periodo estacional: 120, Alpha: 0.9596822552139033, Beta: 0.00010087859009022704, Gamma: 0.024166431682923407 - RMSE: 433.33671041904137, MAE: 368.07026375206516, MAPE: 21.858490398170964%
Trend: mul, Periodo estacional: 150, Alpha: 0.9596428571428571, Beta: 0.0001, Gamma: 0.03228571428571429 - RMSE: 134.17556025860478, MAE: 105.73964093867095, MAPE: 6.757468298013272%
Trend: mul, Periodo estacional: 182, Alpha: 0.9596428571428571, Beta: 0.0001, Gamma: 0.02421428571428572 - RMSE: 186.223173707548, MAE: 150.05846205099678, MAPE: 9.15711509850138%
Trend: mul, Periodo estacional: 200, Alpha: 0.9596428571428571, Beta: 0.0001, Gamma: 0.02421428571428572 - RMSE: 151.73993495822924, MAE: 119.33941149854503, MAPE: 7.475227085648359%
Trend: mul, Periodo estacional: 250, Alpha: 0.9595932919794171, Beta: 0.00031737160791389283, Gamma: 0.03227742765329521 - RMSE: 298.0968167902981, MAE: 246.32836915853397, MAPE: 14.562182134900716%
Trend: mul, Periodo estacional: 270, Alpha: 0.9596428571428571, Beta: 0.0001, Gamma: 0.03228571428571429 - RMSE: 187.0790729701804, MAE: 145.01479750024095, MAPE: 9.14080731585971%
Trend: mul, Periodo estacional: 365, Alpha: 0.9500881121046661, Beta: 0.009598464883178715, Gamma: 0.039988417219020696 - RMSE: 968.955125712491, MAE: 854.1995161520424, MAPE: 51.626530142925745%
Trend: mul, Periodo estacional: 500, Alpha: 0.9603437188178208, Beta: 0.016741099270954705, Gamma: 0.03186200225329522 - RMSE: 847.3540119349422, MAE: 737.8039538154438, MAPE: 44.312147558488455%
Trend: mul, Periodo estacional: 700, Alpha: 0.995, Beta: 0.0001, Gamma: 0.0050000000000000044 - RMSE: 205.87013214010247, MAE: 159.40418279545435, MAPE: 10.024817160017726%
Trend: mul, Periodo estacional: 800, Alpha: 0.995, Beta: 0.0001, Gamma: 0.0001 - RMSE: 131.36536570669602, MAE: 103.21390342267966, MAPE: 6.712426442867043%
Trend: mul, Periodo estacional: 1000, Alpha: 0.9675150739426385, Beta: 0.025404085892075434, Gamma: 0.03070012300806048 - RMSE: 759.7170432374949, MAE: 658.5292296811666, MAPE: 39.44670999496433%
Trend: mul, Periodo estacional: 1500, Alpha: 0.995, Beta: 0.0001, Gamma: 0.0001 - RMSE: 263.68174251225076, MAE: 210.09727740967455, MAPE: 12.32752013737917%
Trend: mul, Periodo estacional: 2080, Alpha: 0.9933845951184266, Beta: 9.967808391462293e-05, Gamma: 0.006615391296577403 - RMSE: 419.0554644734017, MAE: 354.85558657465526, MAPE: 21.07118535212939%
Trend: mul, Periodo estacional: 3000, Alpha: 0.9596428571428571, Beta: 0.0001, Gamma: 0.04035714285714287 - RMSE: 326.7797448093903, MAE: 256.822265798159, MAPE: 14.83769580126158%

Mejor combinación de parámetros: {&#39;trend&#39;: &#39;mul&#39;, &#39;seasonal_period&#39;: 800, &#39;alpha&#39;: 0.995, &#39;beta&#39;: 0.0001, &#39;gamma&#39;: 0.0001, &#39;rmse&#39;: 131.36536570669602, &#39;mae&#39;: 103.21390342267966, &#39;mape&#39;: 6.712426442867043}
</pre></div>
</div>
</div>
</div>
<section id="resultados-de-los-periodos-estacionales-para-el-modelo-holt-winters">
<h2>Resultados de los Periodos Estacionales para el Modelo Holt-Winters<a class="headerlink" href="#resultados-de-los-periodos-estacionales-para-el-modelo-holt-winters" title="Link to this heading">#</a></h2>
<p>Después del proceso de optimización, los <strong>periodos estacionales</strong> con mejor desempeño fueron <strong>800, 150, 3000, 200 y 182 días</strong>. Estos resultados, sin embargo, no muestran una mejora significativa en comparación con el modelo sin componente, ya que todos presentaron precisiones ligeramente menores que este (MAPE de 6.69% para USD y 6.50% para EUR).</p>
<ul class="simple">
<li><p><strong>Periodo estacional: 800 días</strong> - MAPE: 6.71%</p></li>
<li><p><strong>Periodo estacional: 150 días</strong> - MAPE: 6.76%</p></li>
<li><p><strong>Periodo estacional: 3000 días</strong> - MAPE: 7.97%</p></li>
<li><p><strong>Periodo estacional: 200 días</strong> - MAPE: 7.48%</p></li>
<li><p><strong>Periodo estacional: 182 días</strong> - MAPE: 9.16%</p></li>
</ul>
<section id="precision-de-las-predicciones">
<h3>Precisión de las Predicciones:<a class="headerlink" href="#precision-de-las-predicciones" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>MAPE, RMSE y MAE</strong>: Los valores de <strong>MAPE</strong> para los cinco mejores periodo estacianales se encuentran entre 6.71% y 9.16%, lo que indica que la inclusión de estacionalidad no ha mejorado sustancialmente el ajuste respecto al modelo sin estacionalidad (MAPE de 6.69% y 6.50% para USD y EUR). En términos de <strong>RMSE</strong> y <strong>MAE</strong>, los resultados con estacionalidad son en general similares o levemente inferiores al modelo sin estacionalidad, lo que sugiere que el componente estacional no aporta beneficios significativos en la capacidad predictiva.</p></li>
</ul>
</section>
<section id="analisis-de-alpha-beta-y-gamma">
<h3>Análisis de Alpha, Beta y Gamma:<a class="headerlink" href="#analisis-de-alpha-beta-y-gamma" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Alpha</strong>: En todos los resultados, <strong>Alpha</strong> se mantiene muy alto (cercano a 1.0), a diferencia del modelo sin estacionalidad, lo que indica priorización de las observaciones recientes.</p></li>
<li><p><strong>Beta y Gamma</strong>: Los valores de <strong>Beta</strong> y <strong>Gamma</strong> son extremadamente bajos (~0.0001 en todas las combinaciones), en contraste con los valores del modelo sin estacionalidad (Beta: 0.12). Esto sugiere que la inclusión de la estacionalidad tiene un impacto leve en la precisión de este modelo además, los bajos valores de <strong>Gamma</strong> refuerzan que el componente estacional tiene un efecto mínimo en la misma, reforzando la no estacionalidad observada en el <strong>EDA</strong>.</p></li>
</ul>
</section>
</section>
<section id="conclusion-del-componente-estacional">
<h2>Conclusión del Componente Estacional:<a class="headerlink" href="#conclusion-del-componente-estacional" title="Link to this heading">#</a></h2>
<p>Los valores de <strong>Alpha</strong>, <strong>Beta</strong> y <strong>Gamma</strong> indican que el modelo depende de las observaciones recientes y mantiene una tendencia estable, mientras que la estacionalidad tiene un impacto limitado. La inclusión de estacionalidad no ha aportado mejoras significativas en el ajuste ni en la precisión, lo cual concuerda con el EDA, que mostró una estacionalidad débil en los datos de precios del oro.</p>
</section>
<section id="visualizacion-y-comparacion-grafica-de-modelos-estacionales-y-benchmark">
<h2>Visualización y Comparación Gráfica de Modelos Estacionales y Benchmark<a class="headerlink" href="#visualizacion-y-comparacion-grafica-de-modelos-estacionales-y-benchmark" title="Link to this heading">#</a></h2>
<p>Se realizara una <strong>comparación gráfica</strong> entre los dos modelos estacionales con mejor desempeño y un modelo benchmark sin componente estacional. Esta comparación permitira evaluar visualmente las diferencias en la precisión de las predicciones y revisar el ajuste de los modelos de la tendencia de los precios del oro.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">logging</span><span class="o">.</span><span class="n">captureWarnings</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Comparativo combinaciones de alpha, beta y gamma</span>
<span class="n">top_models</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.995</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">:</span> <span class="mf">0.0001</span><span class="p">,</span> <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="mf">0.0001</span><span class="p">,</span> <span class="s1">&#39;seasonal_period&#39;</span><span class="p">:</span> <span class="mi">800</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Top 1&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.9596</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">:</span> <span class="mf">0.0001</span><span class="p">,</span> <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="mf">0.0323</span><span class="p">,</span> <span class="s1">&#39;seasonal_period&#39;</span><span class="p">:</span> <span class="mi">150</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Top 2&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.23</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">:</span> <span class="mf">0.12</span><span class="p">,</span> <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;seasonal_period&#39;</span><span class="p">:</span> <span class="mi">31</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;benchmark&#39;</span><span class="p">}</span>
<span class="p">]</span>

<span class="c1"># Establecer &#39;Date&#39; como índice para el análisis de HW</span>
<span class="n">daily_gold_rate_hs_seasonal</span> <span class="o">=</span> <span class="n">daily_gold_rate_benchmark</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">daily_gold_rate_hs_seasonal</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Establecer la frecuencia del índice como diaria</span>
<span class="n">daily_gold_rate_hs_seasonal</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">daily_gold_rate_hs_seasonal</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">daily_gold_rate_hs_seasonal</span> <span class="o">=</span> <span class="n">daily_gold_rate_hs_seasonal</span><span class="o">.</span><span class="n">asfreq</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">)</span>  <span class="c1"># Días hábiles</span>


<span class="c1"># División del conjunto de datos en entrenamiento y prueba</span>
<span class="n">train_size_hs_seasonal</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">daily_gold_rate_hs_seasonal</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
<span class="n">train_data_hs_seasonal</span> <span class="o">=</span> <span class="n">daily_gold_rate_hs_seasonal</span><span class="p">[:</span><span class="n">train_size_hs_seasonal</span><span class="p">]</span>
<span class="n">test_data_hs_seasonal</span> <span class="o">=</span> <span class="n">daily_gold_rate_hs_seasonal</span><span class="p">[</span><span class="n">train_size_hs_seasonal</span><span class="p">:]</span>

<span class="c1"># Función para ejecutar el modelo, calcular métricas y graficar resultados</span>
<span class="k">def</span> <span class="nf">ejecutar_modelo_final</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">seasonal_period</span><span class="p">,</span> <span class="n">currency_data</span><span class="p">,</span> <span class="n">test_data</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
    <span class="c1"># Entrenar el modelo</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">ExponentialSmoothing</span><span class="p">(</span><span class="n">currency_data</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="s1">&#39;mul&#39;</span><span class="p">,</span> <span class="n">seasonal</span><span class="o">=</span><span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="n">seasonal_periods</span><span class="o">=</span><span class="n">seasonal_period</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
        <span class="n">smoothing_level</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">smoothing_trend</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span> <span class="n">smoothing_seasonal</span><span class="o">=</span><span class="n">gamma</span><span class="p">)</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test_data</span><span class="p">))</span>

    <span class="c1"># Calcular métricas</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">test_data</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
    <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">test_data</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">test_data</span> <span class="o">-</span> <span class="n">predictions</span><span class="p">)</span> <span class="o">/</span> <span class="n">test_data</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>

    <span class="c1"># Imprimir las métricas</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Resultados </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  RMSE: </span><span class="si">{</span><span class="n">rmse</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  MAE: </span><span class="si">{</span><span class="n">mae</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  MAPE: </span><span class="si">{</span><span class="n">mape</span><span class="si">}</span><span class="s2">%</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Graficar los resultados</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">currency_data</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">currency_data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Datos de Entrenamiento (USD)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_data</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">test_data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Valores Reales (USD)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_data</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Predicciones </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1"> (USD)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Precio del Oro (USD)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Comparación de Valores Reales y Predichos para USD (</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Ejecutar el modelo final para los mejores parámetros</span>
<span class="k">for</span> <span class="n">model_params</span> <span class="ow">in</span> <span class="n">top_models</span><span class="p">:</span>
    <span class="n">ejecutar_modelo_final</span><span class="p">(</span>
        <span class="n">alpha</span><span class="o">=</span><span class="n">model_params</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">],</span>
        <span class="n">beta</span><span class="o">=</span><span class="n">model_params</span><span class="p">[</span><span class="s1">&#39;beta&#39;</span><span class="p">],</span>
        <span class="n">gamma</span><span class="o">=</span><span class="n">model_params</span><span class="p">[</span><span class="s1">&#39;gamma&#39;</span><span class="p">],</span>
        <span class="n">seasonal_period</span><span class="o">=</span><span class="n">model_params</span><span class="p">[</span><span class="s1">&#39;seasonal_period&#39;</span><span class="p">],</span>
        <span class="n">currency_data</span><span class="o">=</span><span class="n">train_data_hs_seasonal</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">],</span>
        <span class="n">test_data</span><span class="o">=</span><span class="n">test_data_hs_seasonal</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">],</span>
        <span class="n">label</span><span class="o">=</span><span class="n">model_params</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resultados Top 1:
  RMSE: 131.36536570669602
  MAE: 103.21390342267966
  MAPE: 6.712426442867043%
</pre></div>
</div>
<img alt="_images/111bf42ae36b702ebb909d079fd710a5a24415a2c9f06a003899673e93a9b9f1.png" src="_images/111bf42ae36b702ebb909d079fd710a5a24415a2c9f06a003899673e93a9b9f1.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resultados Top 2:
  RMSE: 134.1766117705416
  MAE: 105.74034938882657
  MAPE: 6.7575016034537985%
</pre></div>
</div>
<img alt="_images/61586694e31dcc1f5c4bdfae0bf86425bf26a909ca4659f71c19ced0a736432d.png" src="_images/61586694e31dcc1f5c4bdfae0bf86425bf26a909ca4659f71c19ced0a736432d.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resultados benchmark:
  RMSE: 131.34393339956452
  MAE: 103.54988270423313
  MAPE: 6.669229186654182%
</pre></div>
</div>
<img alt="_images/3148d2339086d64574234a4cc9e0116e1d0b0618709b55d22d44badfb0fe8e95.png" src="_images/3148d2339086d64574234a4cc9e0116e1d0b0618709b55d22d44badfb0fe8e95.png" />
</div>
</div>
</section>
</section>
<section id="interpretacion-de-los-resultados-de-los-modelos-estacionales-y-benchmark">
<h1>Interpretación de los Resultados de los Modelos Estacionales y Benchmark<a class="headerlink" href="#interpretacion-de-los-resultados-de-los-modelos-estacionales-y-benchmark" title="Link to this heading">#</a></h1>
<p>Los gráficos y las métricas obtenidas para los dos modelos estacionales con mejor desempeño , y el <strong>modelo benchmark</strong> sin componente estacional permiten hacer una comparación clara del rendimiento predictivo de cada modelo. A continuación, se detallan las observaciones clave:</p>
<section id="id2">
<h2>Interpretación de los Resultados:<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Los valores de <strong>MAPE</strong> para los tres modelos son muy similares, con diferencias mínimas. El <strong>modelo benchmark</strong> y el <strong>Top 1</strong> presentan un rendimiento casi idéntico, con una ligera ventaja en <strong>MAE</strong> y <strong>MAPE</strong> para el <strong>benchmark</strong>.</p></li>
<li><p>En términos de <strong>RMSE</strong> y <strong>MAE</strong>, el <strong>Top 1</strong> y el <strong>benchmark</strong> están casi empatados, mientras que el <strong>Top 2</strong> presenta un error ligeramente mayor. Esto indica que la estacionalidad no ha logrado mejorar el ajuste considerablemente en comparación con el modelo sin estacionalidad.</p></li>
</ul>
</section>
<section id="analisis-grafico">
<h2>Análisis Gráfico :<a class="headerlink" href="#analisis-grafico" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Los tres gráficos muestran que los modelos logran capturar correctamente la <strong>tendencia general</strong> de los precios del oro, pero no son capaces de reflejar con precisión las <strong>fluctuaciones de corto plazo</strong>. En todos los casos, las predicciones muestran una línea suave que sigue el aumento de los precios, pero no logran ajustarse a las variaciones más rápidas o abruptas.</p></li>
<li><p>La gráfica del <strong>Top 1</strong> presenta un comportamiento muy similar al del <strong>benchmark</strong>, lo que refuerza los resultados numéricos: ambos modelos capturan la tendencia general de manera casi idéntica.</p></li>
</ul>
<p>El <strong>modelo benchmark</strong> sin estacionalidad y los modelos etsacionales muestran un rendimiento prácticamente igual, con diferencias marginales en las métricas de error. Esto confirma que la inclusión de un componente estacional no mejora significativamente la precisión del modelo para los precios del oro, ya que no se observan patrones estacionales claros en el comportamiento de los datos. Aunque se probaron varios periodos estacionales, la tendencia a largo plazo parece ser el principal factor que influye en las predicciones con poca o ninguna mejora al añadir estacionalidad.</p>
</section>
</section>
<section id="conclusion-general-del-modelo-holt-winters-para-los-precios-del-oro">
<h1>Conclusión General del Modelo Holt-Winters para los Precios del Oro<a class="headerlink" href="#conclusion-general-del-modelo-holt-winters-para-los-precios-del-oro" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p>El <strong>modelo Holt-Winters</strong> demostró ser efectivo para capturar la <strong>tendencia general</strong> de los precios del oro en <strong>USD</strong> y <strong>EUR</strong>, mostrando mejoras significativas respecto al modelo <strong>Suavizado Exponencial (ES)</strong>. Sin embargo, los resultados evidenciaron que la inclusión de un <strong>componente estacional</strong> no aportó mejoras notables en la precisión predictiva.</p></li>
<li><p>En términos de métricas como <strong>RMSE</strong>, <strong>MAE</strong>, y <strong>MAPE</strong>, los modelos estacionales lograron rendimientos similares al modelo sin estacionalidad, lo que refuerza la conclusión de que el comportamiento de los precios del oro no muestra un patrón estacional claro. La estacionalidad, aunque fue probada con diversos periodos, mostró un <strong>impacto mínimo</strong> en las predicciones.</p></li>
<li><p>El modelo es adecuado para capturar la <strong>tendencia a largo plazo</strong>, pero sigue presentando dificultades para reflejar las <strong>fluctuaciones de corto plazo</strong> o <strong>volatilidad</strong> en los precios tal como el modelo <strong>ES</strong>. Este comportamiento sugiere que, para mejorar la precisión en el pronóstico del oro, sería recomendable explorar modelos más capaces de reaccionar a cambios abruptos y a la volatilidad del mercado.</p></li>
</ul>
</section>
<section id="introduccion-al-modelo-arima">
<h1>Introducción al Modelo ARIMA<a class="headerlink" href="#introduccion-al-modelo-arima" title="Link to this heading">#</a></h1>
<p>El modelo <strong>ARIMA</strong> (Autoregressive Integrated Moving Average) es uno de los métodos de referencia para el análisis de series temporales sin estacionalidad. Este modelo es adecuado para series temporales donde la relación entre los datos está determinada por su estructura autoregresiva (AR) y de media móvil (MA), permitiendo además un proceso de integración (I) para transformar datos no estacionarios en una serie estacionaria.</p>
<p>Dado que nuestra serie de precios del oro no es estacionaria, el modelo <strong>ARIMA</strong> se implementará con un paso previo de diferenciación para estabilizar la media y cumplir con este requisito. El análisis de los valores de <strong>p</strong> (autoregresión), <strong>d</strong> (diferenciación), y <strong>q</strong> (media móvil) se determinará a partir de:</p>
<ul class="simple">
<li><p><strong>Prueba de Dickey-Fuller Aumentada (ADF)</strong>: Evaluación de la estacionariedad de la serie.</p></li>
<li><p><strong>Gráficos ACF y PACF</strong>: Identificación de los posibles valores para <strong>p</strong> y <strong>q</strong> que describen las relaciones autorregresivas y de media móvil en la serie.</p></li>
</ul>
<p>Este proceso permitirá optimizar los parámetros de <strong>ARIMA</strong> para capturar las características más significativas de los precios del oro y maximizar la precisión del modelo predictivo en nuestra base de datos.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="implementacion-del-modelo-arima-para-prediccion-de-precios-del-oro">
<h1>Implementación del Modelo ARIMA para Predicción de Precios del Oro<a class="headerlink" href="#implementacion-del-modelo-arima-para-prediccion-de-precios-del-oro" title="Link to this heading">#</a></h1>
<p>El modelo <strong>ARIMA</strong> se utiliza en series temporales para realizar predicciones basadas en patrones y tendencias observadas en datos históricos. Este modelo es adecuado para series que no muestran estacionalidad, como en nuestro caso. Para la implementación de este modelo, los datos deben cumplir con el criterio de estacionariedad, un requisito esencial en modelos de series temporales.</p>
<p>Dado que los precios del oro han mostrado <strong>no estacionaridad</strong> en nuestro análisis exploratorio, el modelo <strong>ARIMA</strong> se aplicará después de una diferenciación de la serie, ajustando sus parámetros para capturar mejor la tendencia y las fluctuaciones del precio a lo largo del tiempo.</p>
<p>Los componentes a optimizar del ARIMA son:</p>
<ul class="simple">
<li><p><strong>Componente AR (AutoRegressive order - p)</strong></p></li>
<li><p><strong>Componente I (Integrated order - d)</strong></p></li>
<li><p><strong>Componente MA (Moving Average order - q)</strong></p></li>
</ul>
<section id="transformacion-en-la-serie-de-precios-del-oro">
<h2>Transformación en la Serie de Precios del Oro<a class="headerlink" href="#transformacion-en-la-serie-de-precios-del-oro" title="Link to this heading">#</a></h2>
<p>Dado que los precios del oro no presentan <strong>estacionariedad</strong> en su comportamiento , es necesario realizar una <strong>transformación</strong> en los datos para que cumplan con este criterio, ya que este es fundamental en modelos como <strong>ARIMA</strong>. La <strong>diferenciación</strong> será aplicada para estabilizar la media y eliminar tendencias a largo plazo, permitiendo que el modelo capture con mayor precisión las fluctuaciones en la serie temporal.</p>
<p>Este proceso ajustará los datos para hacerlos más adecuados al análisis y modelado, facilitando una mejor identificación de patrones.</p>
<section id="aplicacion-de-transformacion-con-difrenciacion">
<h3>Aplicacion de Transformación con difrenciacion<a class="headerlink" href="#aplicacion-de-transformacion-con-difrenciacion" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importar librerías necesarias</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.stattools</span> <span class="kn">import</span> <span class="n">adfuller</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Crear copia de los datos originales</span>
<span class="n">daily_gold_rate_AR</span> <span class="o">=</span> <span class="n">daily_gold_rate_benchmark</span><span class="p">[[</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="s1">&#39;USD&#39;</span><span class="p">,</span> <span class="s1">&#39;EUR&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">daily_gold_rate_AR</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Prueba Dickey-Fuller antes de la transformación</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Pruebas Dickey-Fuller antes de la transformación:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">adf_test_usd_before</span> <span class="o">=</span> <span class="n">adfuller</span><span class="p">(</span><span class="n">daily_gold_rate_AR</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;USD (Antes):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Estadístico ADF: </span><span class="si">{</span><span class="n">adf_test_usd_before</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-valor: </span><span class="si">{</span><span class="n">adf_test_usd_before</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Valores críticos: </span><span class="si">{</span><span class="n">adf_test_usd_before</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">adf_test_usd_before</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0.05</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;La serie es estacionaria</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;La serie NO es estacionaria</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">adf_test_eur_before</span> <span class="o">=</span> <span class="n">adfuller</span><span class="p">(</span><span class="n">daily_gold_rate_AR</span><span class="p">[</span><span class="s1">&#39;EUR&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;EUR (Antes):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Estadístico ADF: </span><span class="si">{</span><span class="n">adf_test_eur_before</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-valor: </span><span class="si">{</span><span class="n">adf_test_eur_before</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Valores críticos: </span><span class="si">{</span><span class="n">adf_test_eur_before</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">adf_test_eur_before</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0.05</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;La serie es estacionaria</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;La serie NO es estacionaria</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Aplicar primera diferenciación sin transformación logarítmica</span>
<span class="n">daily_gold_rate_AR</span><span class="p">[</span><span class="s1">&#39;USD_diff&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">daily_gold_rate_AR</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">daily_gold_rate_AR</span><span class="p">[</span><span class="s1">&#39;EUR_diff&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">daily_gold_rate_AR</span><span class="p">[</span><span class="s1">&#39;EUR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="c1"># Prueba Dickey-Fuller después de la diferenciación</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Pruebas Dickey-Fuller después de la primera diferenciación:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">adf_test_usd_after</span> <span class="o">=</span> <span class="n">adfuller</span><span class="p">(</span><span class="n">daily_gold_rate_AR</span><span class="p">[</span><span class="s1">&#39;USD_diff&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;USD (Después):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Estadístico ADF: </span><span class="si">{</span><span class="n">adf_test_usd_after</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-valor: </span><span class="si">{</span><span class="n">adf_test_usd_after</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Valores críticos: </span><span class="si">{</span><span class="n">adf_test_usd_after</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">adf_test_usd_after</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0.05</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;La serie es estacionaria</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;La serie NO es estacionaria</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">adf_test_eur_after</span> <span class="o">=</span> <span class="n">adfuller</span><span class="p">(</span><span class="n">daily_gold_rate_AR</span><span class="p">[</span><span class="s1">&#39;EUR_diff&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;EUR (Después):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Estadístico ADF: </span><span class="si">{</span><span class="n">adf_test_eur_after</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-valor: </span><span class="si">{</span><span class="n">adf_test_eur_after</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Valores críticos: </span><span class="si">{</span><span class="n">adf_test_eur_after</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">adf_test_eur_after</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0.05</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;La serie es estacionaria</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;La serie NO es estacionaria</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># División de los datos transformados en entrenamiento y prueba (80% entrenamiento, 20% prueba)</span>
<span class="n">train_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">daily_gold_rate_AR</span><span class="o">.</span><span class="n">dropna</span><span class="p">())</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
<span class="n">train_data_usd_AR</span> <span class="o">=</span> <span class="n">daily_gold_rate_AR</span><span class="p">[</span><span class="s1">&#39;USD_diff&#39;</span><span class="p">][:</span><span class="n">train_size</span><span class="p">]</span>
<span class="n">test_data_usd_AR</span> <span class="o">=</span> <span class="n">daily_gold_rate_AR</span><span class="p">[</span><span class="s1">&#39;USD_diff&#39;</span><span class="p">][</span><span class="n">train_size</span><span class="p">:]</span>
<span class="n">train_data_eur_AR</span> <span class="o">=</span> <span class="n">daily_gold_rate_AR</span><span class="p">[</span><span class="s1">&#39;EUR_diff&#39;</span><span class="p">][:</span><span class="n">train_size</span><span class="p">]</span>
<span class="n">test_data_eur_AR</span> <span class="o">=</span> <span class="n">daily_gold_rate_AR</span><span class="p">[</span><span class="s1">&#39;EUR_diff&#39;</span><span class="p">][</span><span class="n">train_size</span><span class="p">:]</span>

<span class="c1"># Visualización de los datos transformados para USD </span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">train_data_usd_AR</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">train_data_usd_AR</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Entrenamiento USD&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_data_usd_AR</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">test_data_usd_AR</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Prueba USD&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Valor Diferenciado USD&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Datos Transformados (Primera Diferenciación) para USD&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Visualización de los datos transformados para EUR </span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">train_data_eur_AR</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">train_data_eur_AR</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Entrenamiento EUR&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_data_eur_AR</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">test_data_eur_AR</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Prueba EUR&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Valor Diferenciado EUR&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Datos Transformados (Primera Diferenciación) para EUR&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pruebas Dickey-Fuller antes de la transformación:

USD (Antes):
Estadístico ADF: 0.08926533923192043
p-valor: 0.965320500541408
Valores críticos: {&#39;1%&#39;: -3.430999291944839, &#39;5%&#39;: -2.8618269486484413, &#39;10%&#39;: -2.566922737625234}
La serie NO es estacionaria

EUR (Antes):
Estadístico ADF: 1.0861413502132413
p-valor: 0.9950965917581289
Valores críticos: {&#39;1%&#39;: -3.430999291944839, &#39;5%&#39;: -2.8618269486484413, &#39;10%&#39;: -2.566922737625234}
La serie NO es estacionaria

Pruebas Dickey-Fuller después de la primera diferenciación:

USD (Después):
Estadístico ADF: -16.96652695649502
p-valor: 9.225551498256222e-30
Valores críticos: {&#39;1%&#39;: -3.430999356419923, &#39;5%&#39;: -2.8618269771395015, &#39;10%&#39;: -2.5669227527910543}
La serie es estacionaria

EUR (Después):
Estadístico ADF: -16.983182181848544
p-valor: 8.981056153911323e-30
Valores críticos: {&#39;1%&#39;: -3.430999291944839, &#39;5%&#39;: -2.8618269486484413, &#39;10%&#39;: -2.566922737625234}
La serie es estacionaria
</pre></div>
</div>
<img alt="_images/9b7db73fdceaf21993b81eb3bbdd0341c78ccba7f370722713342a58771774b6.png" src="_images/9b7db73fdceaf21993b81eb3bbdd0341c78ccba7f370722713342a58771774b6.png" />
<img alt="_images/a3cb080d57879b4c327ec3eb85ab9689c0764861c1531e740f2123577bc87dd0.png" src="_images/a3cb080d57879b4c327ec3eb85ab9689c0764861c1531e740f2123577bc87dd0.png" />
</div>
</div>
</section>
</section>
<section id="resultados-de-la-transformacion-logaritmica-con-diferenciacion">
<h2>Resultados de la Transformación Logarítmica con Diferenciación<a class="headerlink" href="#resultados-de-la-transformacion-logaritmica-con-diferenciacion" title="Link to this heading">#</a></h2>
<p>Después de aplicar la transformación logarítmica a los datos de precios del oro en <strong>USD</strong> y <strong>EUR</strong>, se verificó la estacionariedad mediante la prueba <strong>Dickey-Fuller Aumentada (ADF)</strong>. Los resultados confirmaron que la serie temporal original no era estacionaria como se observó en el <strong>EDA</strong>, pero tras la transformación, ambas series (USD y EUR) se convirtieron exitosamente en estacionarias, lo cual es necesario para proceder con el modelo <strong>ARIMA</strong>.</p>
<section id="observaciones">
<h3>Observaciones<a class="headerlink" href="#observaciones" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Se aprecia una disminución significativa en la tendencia de largo plazo.</p></li>
<li><p>Los resultados de la prueba <strong>Dickey-Fuller</strong> confirman que las series son ahora estacionarias.</p></li>
</ul>
</section>
</section>
<section id="graficos-acf-y-pacf">
<h2>Gráficos ACF y PACF<a class="headerlink" href="#graficos-acf-y-pacf" title="Link to this heading">#</a></h2>
<p>Los gráficos de <strong>Autocorrelación (ACF)</strong> y <strong>Autocorrelación Parcial (PACF)</strong> permiten identificar los potenciales valores de los componentes <code class="docutils literal notranslate"><span class="pre">p</span></code> y <code class="docutils literal notranslate"><span class="pre">q</span></code> del modelo <strong>ARIMA</strong>.</p>
<ul class="simple">
<li><p>El gráfico de <strong>ACF</strong> ayuda a identificar el componente de <strong>media móvil (q)</strong> al mostrar la correlación entre un valor y sus lags.</p></li>
<li><p>El gráfico de <strong>PACF</strong> es útil para determinar el número de lags en el componente <strong>autorregresivo (p)</strong>.</p></li>
</ul>
<section id="visualizacion-de-graficos-acf-y-pacf">
<h3>Visualizacion de Gráficos ACF y PACF<a class="headerlink" href="#visualizacion-de-graficos-acf-y-pacf" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.graphics.tsaplots</span> <span class="kn">import</span> <span class="n">plot_acf</span><span class="p">,</span> <span class="n">plot_pacf</span>

<span class="c1"># Gráfico ACF y PACF para USD transformado</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">plot_acf</span><span class="p">(</span><span class="n">daily_gold_rate_AR</span><span class="p">[</span><span class="s1">&#39;USD_diff&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ACF para USD &#39;</span><span class="p">)</span>

<span class="n">plot_pacf</span><span class="p">(</span><span class="n">daily_gold_rate_AR</span><span class="p">[</span><span class="s1">&#39;USD_diff&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;PACF para USD &#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Gráfico ACF y PACF para EUR transformado</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">plot_acf</span><span class="p">(</span><span class="n">daily_gold_rate_AR</span><span class="p">[</span><span class="s1">&#39;EUR_diff&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;ACF para EUR &#39;</span><span class="p">)</span>

<span class="n">plot_pacf</span><span class="p">(</span><span class="n">daily_gold_rate_AR</span><span class="p">[</span><span class="s1">&#39;EUR_diff&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;PACF para EUR &#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6fab654447d7033574737431d60a654324281246d36e4cf24c4f1586af227146.png" src="_images/6fab654447d7033574737431d60a654324281246d36e4cf24c4f1586af227146.png" />
<img alt="_images/cf8c43c43beeb10f9d796ca42190f7a71da69f101053bd3d9ca9fd9d7fd46f4c.png" src="_images/cf8c43c43beeb10f9d796ca42190f7a71da69f101053bd3d9ca9fd9d7fd46f4c.png" />
</div>
</div>
</section>
</section>
<section id="interpretacion-de-las-graficas-acf-y-pacf">
<h2>Interpretación de las Gráficas ACF y PACF<a class="headerlink" href="#interpretacion-de-las-graficas-acf-y-pacf" title="Link to this heading">#</a></h2>
<p>En los gráficos de <strong>ACF</strong> y <strong>PACF</strong> se observa lo siguiente:</p>
<ul class="simple">
<li><p><strong>ACF</strong>: La autocorrelación en el retardo 0 es alta, pero decrece  partir del primer retardo, estabilizándose cerca de cero. Esto indica que no existe una autocorrelación significativa en retardos mas alla del primero.</p></li>
<li><p><strong>PACF</strong>: La función de autocorrelación parcial muestra un corte abrupto después del primer retardolo que como en que este modelo podria ser representado por un retardo simple.</p></li>
</ul>
</section>
<section id="parametros-iniciales-del-modelo-arima">
<h2>Parámetros Iniciales del Modelo ARIMA<a class="headerlink" href="#parametros-iniciales-del-modelo-arima" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>p (Orden Autorregresivo)</strong>: Para este parametro incial <strong>p = 1</strong> parece ser indicado ya que PACF muestra un corte abrupto en el primer retardo.</p></li>
<li><p><strong>q (Orden de Media Móvil)</strong>: El gráfico ACF indica que un valor de <strong>q = 1</strong> es adecuado, debido a la caída brusca en el primer retardo.</p></li>
<li><p><strong>d (Diferenciación)</strong>: La serie se volvió estacionaria después de una diferenciación simple, por lo que se utilizará <strong>d = 1</strong>.</p></li>
</ul>
<section id="optimizacion-de-parametros-modelo-arima">
<h3>Optimizacion de parametros Modelo ARIMA<a class="headerlink" href="#optimizacion-de-parametros-modelo-arima" title="Link to this heading">#</a></h3>
<p>A partir de los parámetros iniciales identificados (<strong>p = 1</strong>, <strong>d = 1</strong>, <strong>q = 1</strong>), se utilizó un <strong>grid search</strong> para optimizar el modelo mediante la métrica <strong>AIC</strong>. Este proceso exploró diferentes combinaciones de los parametros buscando reducir el <strong>AIC</strong> y encontrar el modelo que mejor se ajusta a los datos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.tsa.arima.model</span> <span class="kn">import</span> <span class="n">ARIMA</span>
<span class="kn">import</span> <span class="nn">logging</span>

<span class="n">logging</span><span class="o">.</span><span class="n">captureWarnings</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Parámetros iniciales para el Grid Search</span>
<span class="c1"># Parámetros más amplios para Grid Search</span>
<span class="n">p_values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">d_values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">q_values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>

<span class="c1"># Función para entrenar el modelo ARIMA y devolver el AIC</span>
<span class="k">def</span> <span class="nf">evaluate_arima_model_aic</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="n">arima_order</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">arima_order</span><span class="p">)</span>
    <span class="n">model_fit</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">model_fit</span><span class="o">.</span><span class="n">aic</span>

<span class="c1"># Uso de TQDM para seguimiento del proceso con la función Grid Search optimizada</span>
<span class="k">def</span> <span class="nf">grid_search_with_progress_aic</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="n">p_values</span><span class="p">,</span> <span class="n">d_values</span><span class="p">,</span> <span class="n">q_values</span><span class="p">):</span>
    <span class="n">best_score</span><span class="p">,</span> <span class="n">best_cfg</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">),</span> <span class="kc">None</span>
    <span class="n">total_iterations</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p_values</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">d_values</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">q_values</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="n">total_iterations</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Grid Search Progress (AIC)&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">pbar</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">p_values</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">d_values</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">q_values</span><span class="p">:</span>
                    <span class="n">order</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">aic</span> <span class="o">=</span> <span class="n">evaluate_arima_model_aic</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">aic</span> <span class="o">&lt;</span> <span class="n">best_score</span><span class="p">:</span>
                            <span class="n">best_score</span><span class="p">,</span> <span class="n">best_cfg</span> <span class="o">=</span> <span class="n">aic</span><span class="p">,</span> <span class="n">order</span>
                        <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Actualizar barra de progreso</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Actualizar incluso si hay error</span>
                        <span class="k">continue</span>
    <span class="k">return</span> <span class="n">best_cfg</span><span class="p">,</span> <span class="n">best_score</span>

<span class="c1"># Ejecución con paralelización en 16 núcleos y monitorización con TQDM</span>
<span class="k">with</span> <span class="n">parallel_backend</span><span class="p">(</span><span class="s1">&#39;threading&#39;</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">16</span><span class="p">):</span>
    <span class="n">best_order_usd</span><span class="p">,</span> <span class="n">best_aic_usd</span> <span class="o">=</span> <span class="n">grid_search_with_progress_aic</span><span class="p">(</span><span class="n">train_data_usd_AR</span><span class="p">,</span> <span class="n">p_values</span><span class="p">,</span> <span class="n">d_values</span><span class="p">,</span> <span class="n">q_values</span><span class="p">)</span>
    <span class="n">best_order_eur</span><span class="p">,</span> <span class="n">best_aic_eur</span> <span class="o">=</span> <span class="n">grid_search_with_progress_aic</span><span class="p">(</span><span class="n">train_data_eur_AR</span><span class="p">,</span> <span class="n">p_values</span><span class="p">,</span> <span class="n">d_values</span><span class="p">,</span> <span class="n">q_values</span><span class="p">)</span>

<span class="c1"># Mostrar los mejores resultados obtenidos para USD y EUR</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejor ARIMA para USD (AIC): </span><span class="si">{</span><span class="n">best_order_usd</span><span class="si">}</span><span class="s2"> con AIC=</span><span class="si">{</span><span class="n">best_aic_usd</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejor ARIMA para EUR (AIC): </span><span class="si">{</span><span class="n">best_order_eur</span><span class="si">}</span><span class="s2"> con AIC=</span><span class="si">{</span><span class="n">best_aic_eur</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Grid Search Progress (AIC): 100%|██████████| 72/72 [05:02&lt;00:00,  4.20s/it]
Grid Search Progress (AIC): 100%|██████████| 72/72 [04:41&lt;00:00,  3.90s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejor ARIMA para USD (AIC): (3, 1, 4) con AIC=57568.977
Mejor ARIMA para EUR (AIC): (3, 1, 5) con AIC=52902.901
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="interpretacion-de-los-resultados-del-modelo-arima-para-usd-y-eur">
<h3>Interpretación de los Resultados del Modelo ARIMA para USD y EUR<a class="headerlink" href="#interpretacion-de-los-resultados-del-modelo-arima-para-usd-y-eur" title="Link to this heading">#</a></h3>
<p>La optimización del modelo <strong>ARIMA</strong> utilizando <strong>Grid Search</strong> resultó en los siguientes parámetros para los precios del oro en <strong>USD</strong> y <strong>EUR</strong>:</p>
<ul class="simple">
<li><p><strong>USD: ARIMA(3, 1, 4)</strong></p>
<ul>
<li><p><strong>p = 3</strong>: La inclusión de este componente autoregresivo sugiere una dependencia en el tiempo que captura la estructura de los precios recientes, permitiendo al modelo incorporar la memoria de corto plazo en las predicciones.</p></li>
<li><p><strong>d = 1</strong>: La diferenciación de primer orden aplicada previamente ha estabilizado la media de la serie, haciendo que el modelo capture mejor las fluctuaciones al eliminar las tendencias a largo plazo.</p></li>
<li><p><strong>q = 4</strong>: La inclusión de cuatro términos de media móvil indica que el modelo ajusta las predicciones considerando los errores de predicción de los últimos cuatro periodos suavizando la volatilidad de los datos.</p></li>
</ul>
</li>
<li><p><strong>EUR: ARIMA(3, 1, 5)</strong></p>
<ul>
<li><p><strong>q = 5</strong>: La inclusión de cinco términos de media móvil sugiere que el modelo en <strong>EUR</strong> depende de una corrección más detallada en función de los errores de predicción recientes lo que en teoria permitira una mejor precisión en periodos de alta volatilidad.</p></li>
</ul>
</li>
</ul>
<section id="comparacion-de-los-resultados">
<h4>Comparación de los Resultados<a class="headerlink" href="#comparacion-de-los-resultados" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><strong>AIC para USD y EUR</strong>:</p>
<ul>
<li><p>El <strong>AIC</strong> del modelo <strong>EUR</strong> (52902.901) es menor que el de <strong>USD</strong> (57568.977), lo que indica que el modelo en <strong>EUR</strong> tiene un mejor ajuste en comparación con el de <strong>USD</strong>.</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="entrenamiento-evaluacion-y-visualizacion-de-los-modelos-arima">
<h3>Entrenamiento, Evaluación y Visualización de los Modelos ARIMA<a class="headerlink" href="#entrenamiento-evaluacion-y-visualizacion-de-los-modelos-arima" title="Link to this heading">#</a></h3>
<p>Para evaluar los modelos <strong>ARIMA(3, 1, 4)USD</strong> y <strong>ARIMA(3, 1, 5)EUR</strong>, se entrenarán ambos modelos. Posteriormente, se generarán predicciones sobre el conjunto de prueba, y se calcularán las métricas de error <strong>RMSE</strong>, <strong>MAPE</strong> y <strong>MAE</strong> para cuantificar el desempeño predictivo de cada modelo. Finalmente, se graficarán las predicciones en comparación con los datos reales para observar visualmente la precisión y el ajuste del modelo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Definir el tamaño de entrenamiento (80%) para dividir los datos</span>
<span class="n">train_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">daily_gold_rate_AR</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>

<span class="c1"># Datos diferenciados y originales de entrenamiento y prueba para USD</span>
<span class="n">train_data_usd_AR</span> <span class="o">=</span> <span class="n">daily_gold_rate_AR</span><span class="p">[</span><span class="s1">&#39;USD_diff&#39;</span><span class="p">][:</span><span class="n">train_size</span><span class="p">]</span>
<span class="n">test_data_usd_AR</span> <span class="o">=</span> <span class="n">daily_gold_rate_AR</span><span class="p">[</span><span class="s1">&#39;USD_diff&#39;</span><span class="p">][</span><span class="n">train_size</span><span class="p">:]</span>
<span class="n">train_data_usd_orig</span> <span class="o">=</span> <span class="n">daily_gold_rate_AR</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">][:</span><span class="n">train_size</span><span class="p">]</span>
<span class="n">test_data_usd_orig</span> <span class="o">=</span> <span class="n">daily_gold_rate_AR</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">][</span><span class="n">train_size</span><span class="p">:]</span>

<span class="c1"># Datos diferenciados y originales de entrenamiento y prueba para EUR</span>
<span class="n">train_data_eur_AR</span> <span class="o">=</span> <span class="n">daily_gold_rate_AR</span><span class="p">[</span><span class="s1">&#39;EUR_diff&#39;</span><span class="p">][:</span><span class="n">train_size</span><span class="p">]</span>
<span class="n">test_data_eur_AR</span> <span class="o">=</span> <span class="n">daily_gold_rate_AR</span><span class="p">[</span><span class="s1">&#39;EUR_diff&#39;</span><span class="p">][</span><span class="n">train_size</span><span class="p">:]</span>
<span class="n">train_data_eur_orig</span> <span class="o">=</span> <span class="n">daily_gold_rate_AR</span><span class="p">[</span><span class="s1">&#39;EUR&#39;</span><span class="p">][:</span><span class="n">train_size</span><span class="p">]</span>
<span class="n">test_data_eur_orig</span> <span class="o">=</span> <span class="n">daily_gold_rate_AR</span><span class="p">[</span><span class="s1">&#39;EUR&#39;</span><span class="p">][</span><span class="n">train_size</span><span class="p">:]</span>

<span class="c1"># Parámetros optimizados para ARIMA según el AIC</span>
<span class="n">best_order_usd</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">best_order_eur</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="c1"># Función para entrenar, predecir y devolver la predicción a la escala original</span>
<span class="k">def</span> <span class="nf">forecast_arima_original</span><span class="p">(</span><span class="n">train_data_diff</span><span class="p">,</span> <span class="n">test_data_diff</span><span class="p">,</span> <span class="n">original_data</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">currency</span><span class="p">):</span>
    <span class="c1"># Ajustar el modelo ARIMA</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">(</span><span class="n">train_data_diff</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>
    <span class="n">model_fit</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

    <span class="c1"># Predicciones en la serie diferenciada</span>
    <span class="n">predictions_diff</span> <span class="o">=</span> <span class="n">model_fit</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">test_data_diff</span><span class="p">))</span>

    <span class="c1"># Reconstruir la predicción en la escala original</span>
    <span class="n">last_value_orig</span> <span class="o">=</span> <span class="n">original_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">test_data_diff</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># Último valor original antes del conjunto de prueba</span>
    <span class="n">predictions_original_scale</span> <span class="o">=</span> <span class="n">last_value_orig</span> <span class="o">+</span> <span class="n">predictions_diff</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>

    <span class="c1"># Calcular RMSE, MAE, MAPE en la escala original</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">original_data</span><span class="p">[</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">test_data_diff</span><span class="p">):],</span> <span class="n">predictions_original_scale</span><span class="p">))</span>
    <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">original_data</span><span class="p">[</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">test_data_diff</span><span class="p">):],</span> <span class="n">predictions_original_scale</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">original_data</span><span class="p">[</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">test_data_diff</span><span class="p">):]</span> <span class="o">-</span> <span class="n">predictions_original_scale</span><span class="p">)</span> <span class="o">/</span> <span class="n">original_data</span><span class="p">[</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">test_data_diff</span><span class="p">):]))</span> <span class="o">*</span> <span class="mi">100</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">currency</span><span class="si">}</span><span class="s1"> - RMSE: </span><span class="si">{</span><span class="n">rmse</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, MAE: </span><span class="si">{</span><span class="n">mae</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">, MAPE: </span><span class="si">{</span><span class="n">mape</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>

    <span class="c1"># Graficar las predicciones</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">original_data</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">original_data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Real </span><span class="si">{</span><span class="n">currency</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_data_diff</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">predictions_original_scale</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Predicciones </span><span class="si">{</span><span class="n">currency</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Precio del Oro (</span><span class="si">{</span><span class="n">currency</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Predicción con ARIMA en Escala Original para </span><span class="si">{</span><span class="n">currency</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Ejecutar la predicción para USD</span>
<span class="n">forecast_arima_original</span><span class="p">(</span><span class="n">train_data_usd_AR</span><span class="p">,</span> <span class="n">test_data_usd_AR</span><span class="p">,</span> <span class="n">daily_gold_rate_AR</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">],</span> <span class="n">best_order_usd</span><span class="p">,</span> <span class="s1">&#39;USD&#39;</span><span class="p">)</span>

<span class="c1"># Ejecutar la predicción para EUR</span>
<span class="n">forecast_arima_original</span><span class="p">(</span><span class="n">train_data_eur_AR</span><span class="p">,</span> <span class="n">test_data_eur_AR</span><span class="p">,</span> <span class="n">daily_gold_rate_AR</span><span class="p">[</span><span class="s1">&#39;EUR&#39;</span><span class="p">],</span> <span class="n">best_order_eur</span><span class="p">,</span> <span class="s1">&#39;EUR&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>USD - RMSE: 441.130, MAE: 375.101, MAPE: 22.283%
</pre></div>
</div>
<img alt="_images/20a620f0547cb991bfebaca802a55d8eec0df21367dd5dc3f9bc8c74648a5edd.png" src="_images/20a620f0547cb991bfebaca802a55d8eec0df21367dd5dc3f9bc8c74648a5edd.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>EUR - RMSE: 378.362, MAE: 303.197, MAPE: 19.606%
</pre></div>
</div>
<img alt="_images/e97c582eb0413503b03646c1989e3ccf3e0d3bcd459a52653a06072d92dbe3ac.png" src="_images/e97c582eb0413503b03646c1989e3ccf3e0d3bcd459a52653a06072d92dbe3ac.png" />
</div>
</div>
</section>
<section id="id3">
<h3>Interpretación de los Resultados del Modelo ARIMA para USD y EUR<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p>Después de entrenar los modelos <strong>ARIMA(3, 1, 4)</strong> para <strong>USD</strong> y <strong>ARIMA(3, 1, 5)</strong> para <strong>EUR</strong>, se obtuvieron las siguientes métricas de error:</p>
<ul class="simple">
<li><p><strong>USD</strong>:</p>
<ul>
<li><p><strong>RMSE</strong>: 441.130</p></li>
<li><p><strong>MAE</strong>: 375.101</p></li>
<li><p><strong>MAPE</strong>: 22.283%</p></li>
</ul>
</li>
<li><p><strong>EUR</strong>:</p>
<ul>
<li><p><strong>RMSE</strong>: 378.362</p></li>
<li><p><strong>MAE</strong>: 303.197</p></li>
<li><p><strong>MAPE</strong>: 19.606%</p></li>
</ul>
</li>
</ul>
</section>
<section id="analisis-comparativo-con-el-modelo-holt-winters">
<h3>Análisis Comparativo con el Modelo Holt-Winters<a class="headerlink" href="#analisis-comparativo-con-el-modelo-holt-winters" title="Link to this heading">#</a></h3>
<p>Al comparar estos resultados con los obtenidos previamente con el <strong>modelo Holt-Winters</strong>, es evidente que el desempeño del <strong>ARIMA</strong> es inferior. Los valores de <strong>RMSE</strong>, <strong>MAE</strong> y <strong>MAPE</strong> son considerablemente más altos en <strong>ARIMA</strong> que en <strong>Holt-Winters</strong>, lo que indica que el modelo <strong>ARIMA</strong> tiene mayores errores de predicción y no logra ajustarse correctamente a la serie temporal.</p>
<ul class="simple">
<li><p><strong>MAPE</strong>: El valor de <strong>MAPE</strong> del 22.283% para <strong>USD</strong> y 19.606% para <strong>EUR</strong> en el modelo <strong>ARIMA</strong> es significativamente mayor en comparación con el modelo <strong>Holt-Winters</strong>, donde los valores eran alrededor del 6.69% y 6.50%, respectivamente. Esto sugiere que <strong>ARIMA</strong> tiene dificultades para seguir la tendencia general de los precios del oro en ambas divisas, y su precisión en las predicciones es notablemente menor.</p></li>
</ul>
</section>
<section id="falta-de-ajuste-a-la-tendencia">
<h3>Falta de Ajuste a la Tendencia<a class="headerlink" href="#falta-de-ajuste-a-la-tendencia" title="Link to this heading">#</a></h3>
<p>-Las gráficas generadas también refuerzan este punto: las <strong>predicciones de ARIMA</strong> no siguen de manera efectiva la <strong>tendencia ascendente</strong> de los datos reales mostrando una línea de predicción casi plana que no reflejan el crecimiento observada en los precios reales.
-Este comportamiento puede deberse a que el modelo <strong>ARIMA</strong> no está capturando adecuadamente la <strong>tendencia a largo plazo</strong> presente en los precios del oro, lo que es más evidente en las <strong>gráficas</strong> tanto para <strong>USD</strong> como para <strong>EUR</strong>.</p>
</section>
<section id="optimizacion-del-modelo-arima-mediante-grid-search-basado-en-rmse">
<h3>Optimización del Modelo ARIMA mediante Grid Search basado en RMSE<a class="headerlink" href="#optimizacion-del-modelo-arima-mediante-grid-search-basado-en-rmse" title="Link to this heading">#</a></h3>
<p>Con el fin de mejorar la precisión y el ajuste del modelo <strong>ARIMA</strong>, se realizara un <strong>Grid Search</strong> para optimizar el modelo utilizando el <strong>RMSE</strong> como métrica de evaluación.Buscando un modelo mas indicado para reflejar las tendecias de los precios del oro.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.arima.model</span> <span class="kn">import</span> <span class="n">ARIMA</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>


<span class="c1"># Ignorar warnings de convergencia</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="c1"># Usar las variables ya definidas para diferenciación y división de los datos</span>
<span class="n">train_usd_diff</span> <span class="o">=</span> <span class="n">daily_gold_rate_AR</span><span class="p">[</span><span class="s1">&#39;USD_diff&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">daily_gold_rate_AR</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.2</span><span class="p">)]</span>
<span class="n">test_usd_diff</span> <span class="o">=</span> <span class="n">daily_gold_rate_AR</span><span class="p">[</span><span class="s1">&#39;USD_diff&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">daily_gold_rate_AR</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.2</span><span class="p">):]</span>

<span class="n">train_eur_diff</span> <span class="o">=</span> <span class="n">daily_gold_rate_AR</span><span class="p">[</span><span class="s1">&#39;EUR_diff&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">daily_gold_rate_AR</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.2</span><span class="p">)]</span>
<span class="n">test_eur_diff</span> <span class="o">=</span> <span class="n">daily_gold_rate_AR</span><span class="p">[</span><span class="s1">&#39;EUR_diff&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">daily_gold_rate_AR</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.2</span><span class="p">):]</span>

<span class="n">train_usd_original</span> <span class="o">=</span> <span class="n">daily_gold_rate_AR</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">daily_gold_rate_AR</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.2</span><span class="p">)]</span>
<span class="n">test_usd_original</span> <span class="o">=</span> <span class="n">daily_gold_rate_AR</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">daily_gold_rate_AR</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.2</span><span class="p">):]</span>

<span class="n">train_eur_original</span> <span class="o">=</span> <span class="n">daily_gold_rate_AR</span><span class="p">[</span><span class="s1">&#39;EUR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">daily_gold_rate_AR</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.2</span><span class="p">)]</span>
<span class="n">test_eur_original</span> <span class="o">=</span> <span class="n">daily_gold_rate_AR</span><span class="p">[</span><span class="s1">&#39;EUR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">daily_gold_rate_AR</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.2</span><span class="p">):]</span>

<span class="c1"># Definir los rangos de parámetros para (p, d, q)</span>
<span class="n">p</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  
<span class="n">q</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="c1"># Función para buscar los mejores parámetros para una serie dada usando AIC</span>
<span class="k">def</span> <span class="nf">optimize_arima</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">p_values</span><span class="p">,</span> <span class="n">d_values</span><span class="p">,</span> <span class="n">q_values</span><span class="p">):</span>
    <span class="n">best_aic</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span>
    <span class="n">best_order</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">best_model</span> <span class="o">=</span> <span class="kc">None</span>
    
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">p_values</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">d_values</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">q_values</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">model</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">q</span><span class="p">))</span>
                    <span class="n">model_fit</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
                    <span class="n">aic</span> <span class="o">=</span> <span class="n">model_fit</span><span class="o">.</span><span class="n">aic</span>
                    <span class="k">if</span> <span class="n">aic</span> <span class="o">&lt;</span> <span class="n">best_aic</span><span class="p">:</span>
                        <span class="n">best_aic</span> <span class="o">=</span> <span class="n">aic</span>
                        <span class="n">best_order</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
                        <span class="n">best_model</span> <span class="o">=</span> <span class="n">model_fit</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">continue</span>
    <span class="k">return</span> <span class="n">best_order</span><span class="p">,</span> <span class="n">best_aic</span><span class="p">,</span> <span class="n">best_model</span>

<span class="c1"># Optimizar ARIMA para la serie de USD diferenciada</span>
<span class="n">best_order_usd</span><span class="p">,</span> <span class="n">best_aic_usd</span><span class="p">,</span> <span class="n">best_model_usd</span> <span class="o">=</span> <span class="n">optimize_arima</span><span class="p">(</span><span class="n">train_usd_diff</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejores parámetros para USD: </span><span class="si">{</span><span class="n">best_order_usd</span><span class="si">}</span><span class="s2"> con AIC = </span><span class="si">{</span><span class="n">best_aic_usd</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Optimizar ARIMA para la serie de EUR diferenciada</span>
<span class="n">best_order_eur</span><span class="p">,</span> <span class="n">best_aic_eur</span><span class="p">,</span> <span class="n">best_model_eur</span> <span class="o">=</span> <span class="n">optimize_arima</span><span class="p">(</span><span class="n">train_eur_diff</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejores parámetros para EUR: </span><span class="si">{</span><span class="n">best_order_eur</span><span class="si">}</span><span class="s2"> con AIC = </span><span class="si">{</span><span class="n">best_aic_eur</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Entrenar el modelo ARIMA con los mejores parámetros y hacer predicciones</span>
<span class="n">forecasts_usd_diff_optimized</span> <span class="o">=</span> <span class="n">best_model_usd</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">test_usd_diff</span><span class="p">))</span>
<span class="n">forecasts_eur_diff_optimized</span> <span class="o">=</span> <span class="n">best_model_eur</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">test_eur_diff</span><span class="p">))</span>

<span class="c1"># Invertir la diferenciación para obtener las predicciones en la escala original</span>
<span class="n">forecasts_usd_optimized</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">forecasts_usd_diff_optimized</span><span class="p">)</span> <span class="o">+</span> <span class="n">train_usd_original</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">forecasts_eur_optimized</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">forecasts_eur_diff_optimized</span><span class="p">)</span> <span class="o">+</span> <span class="n">train_eur_original</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Calcular el RMSE para USD</span>
<span class="n">rmse_usd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">test_usd_original</span><span class="p">,</span> <span class="n">forecasts_usd_optimized</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RMSE para USD: </span><span class="si">{</span><span class="n">rmse_usd</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Calcular el RMSE para EUR</span>
<span class="n">rmse_eur</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">test_eur_original</span><span class="p">,</span> <span class="n">forecasts_eur_optimized</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RMSE para EUR: </span><span class="si">{</span><span class="n">rmse_eur</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Función para graficar los resultados</span>
<span class="k">def</span> <span class="nf">plot_forecasts</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">forecasts</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">y_title</span><span class="p">):</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">train</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">train</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Train&#39;</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">test</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">test</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Test&#39;</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">test</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">forecasts</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Forecast&#39;</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">template</span><span class="o">=</span><span class="s2">&quot;simple_white&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">),</span> <span class="n">title_text</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
                      <span class="n">width</span><span class="o">=</span><span class="mi">650</span><span class="p">,</span> <span class="n">title_x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;Fecha&#39;</span><span class="p">,</span>
                      <span class="n">yaxis_title</span><span class="o">=</span><span class="n">y_title</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Graficar los pronósticos optimizados para USD</span>
<span class="n">plot_forecasts</span><span class="p">(</span><span class="n">train_usd_original</span><span class="p">,</span> <span class="n">test_usd_original</span><span class="p">,</span> <span class="n">forecasts_usd_optimized</span><span class="p">,</span> <span class="s1">&#39;ARIMA Optimizado - USD&#39;</span><span class="p">,</span> <span class="s1">&#39;Precio del Oro (USD)&#39;</span><span class="p">)</span>

<span class="c1"># Graficar los pronósticos optimizados para EUR</span>
<span class="n">plot_forecasts</span><span class="p">(</span><span class="n">train_eur_original</span><span class="p">,</span> <span class="n">test_eur_original</span><span class="p">,</span> <span class="n">forecasts_eur_optimized</span><span class="p">,</span> <span class="s1">&#39;ARIMA Optimizado - EUR&#39;</span><span class="p">,</span> <span class="s1">&#39;Precio del Oro (EUR)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejores parámetros para USD: (3, 1, 4) con AIC = 57584.22780839961
Mejores parámetros para EUR: (4, 1, 4) con AIC = 52916.84108508153
RMSE para USD: 426.2312264510948
RMSE para EUR: 366.68817807815617
</pre></div>
</div>
</div>
</div>
</section>
<section id="interpretacion-de-los-resultados-del-arima-optimizado-para-usd-y-eur">
<h3>Interpretación de los Resultados del ARIMA Optimizado para USD y EUR<a class="headerlink" href="#interpretacion-de-los-resultados-del-arima-optimizado-para-usd-y-eur" title="Link to this heading">#</a></h3>
<p>El proceso de <strong>Grid Search</strong> utilizando <strong>RMSE</strong> como métrica de optimización resultó en los siguientes parámetros para los modelos <strong>ARIMA</strong> de <strong>USD</strong> y <strong>EUR</strong>:</p>
<ul class="simple">
<li><p><strong>Mejores Parámetros para USD</strong>: ARIMA(3, 1, 4) con un <strong>AIC</strong> de 57584.23</p></li>
<li><p><strong>Mejores Parámetros para EUR</strong>: ARIMA(4, 1, 4) con un <strong>AIC</strong> de 52916.84</p></li>
<li><p><strong>USD: ARIMA(3, 1, 4)</strong>:
El ajuste del modelo ha mejorado ligeramente, pero el <strong>AIC</strong> sigue siendo elevado, lo que sugiere que, aunque el modelo se ajusta mejor que en iteraciones anteriores, aún tiene dificultades para capturar la totalidad de la estructura de los datos.</p></li>
<li><p><strong>EUR: ARIMA(4, 1, 4)</strong>:</p>
<ul>
<li><p>La diferenciación de primer orden (<strong>d = 1</strong>) continúa siendo clave para estabilizar la serie. Con un <strong>AIC</strong> de 52916.84 y un <strong>RMSE</strong> de 366.69, este modelo sigue ajustándose mejor a los datos en comparación con el modelo de <strong>USD</strong>, pero los resultados son lejanos a ser optimos.</p></li>
</ul>
</li>
</ul>
</section>
<section id="comparacion-y-rendimiento">
<h3>Comparación y Rendimiento<a class="headerlink" href="#comparacion-y-rendimiento" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Comparación de RMSE</strong>:</p>
<ul>
<li><p>El <strong>RMSE</strong> del modelo optimizado para <strong>USD</strong> (426.23) y para <strong>EUR</strong> (366.69) indica una ligera mejora con respecto a los valores obtenidos anteriormente, pero las predicciones siguen estando por debajo del rendimiento observado con otros modelos, como <strong>Holt-Winters</strong>.</p></li>
<li><p><strong>EUR</strong> sigue mostrando un mejor ajuste general, lo que sugiere que los precios del oro en <strong>EUR</strong> son más predecibles y menos volátiles que en <strong>USD</strong>.</p></li>
</ul>
</li>
</ul>
</section>
<section id="conclusion-final-del-modelo-arima">
<h3>Conclusión Final del Modelo ARIMA<a class="headerlink" href="#conclusion-final-del-modelo-arima" title="Link to this heading">#</a></h3>
<p>A pesar de la optimización realizada, los resultados muestran que el <strong>modelo ARIMA</strong> sigue teniendo dificultades para ajustar correctamente las series temporales de los precios del oro, especialmente en <strong>USD</strong>. Aunque el <strong>RMSE</strong> ha mejorado ligeramente, los modelos <strong>ARIMA</strong> no logran capturar las fluctuaciones y la tendencia a largo plazo de los datos a difrencia de otros enfoques como <strong>Holt-Winters</strong>.</p>
<p>El modelo <strong>ARIMA</strong> subestima los precios del oro, especialmente en los periodos más recientes, lo que se refleja en las gráficas donde las predicciones no se alinean bien con los valores reales. Estos resultados sugieren que, aunque el <strong>ARIMA</strong> es un modelo útil para series temporales, su aplicación a estos datos no es la más efectiva.</p>
</section>
</section>
<section id="implementacion-del-modelo-de-redes-neuronales-artificiales-ann-para-prediccion-de-precios-del-oro">
<h2>Implementación del Modelo de Redes Neuronales Artificiales (ANN) para Predicción de Precios del Oro<a class="headerlink" href="#implementacion-del-modelo-de-redes-neuronales-artificiales-ann-para-prediccion-de-precios-del-oro" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Las <strong>Redes Neuronales Artificiales (ANN)</strong> son un enfoque popular para la predicción de series temporales debido a su capacidad de aprender patrones no lineales y complejos en los datos. Este modelo consiste en capas de neuronas interconectadas que procesan la información a través de funciones de activación, permitiendo  capturar patrones complejos en la tendecia a difrencia de modelos tradicionales como <strong>ARIMA</strong> o <strong>Holt-Winters</strong>.</p></li>
<li><p>En este proceso, se implementará un modelo <strong>ANN</strong> utilizando los datos de precios del oro en <strong>USD</strong> y <strong>EUR</strong>, esperando comparar su desempeño con los otros modelos de benchmark previamente evaluados. Se entrenará el modelo utilizando llas series de tiempo y se evaluará su capacidad predictiva mediante métricas como <strong>RMSE</strong>, <strong>MAE</strong>, y <strong>MAPE</strong>, al igual que en los modelos anteriores.</p></li>
</ul>
<section id="preprocesamiento-de-datos-normalizacion-de-las-divisas-usd-y-eur">
<h3>Preprocesamiento de Datos: Normalización de las Divisas USD y EUR<a class="headerlink" href="#preprocesamiento-de-datos-normalizacion-de-las-divisas-usd-y-eur" title="Link to this heading">#</a></h3>
<p>En esta fase, se realizara el preprocesamiento de los datos de las divisas <strong>USD</strong> y <strong>EUR</strong> mediante la <strong>normalización</strong>, una transformación esencial para preparar los datos de series temporales antes de su uso en redes neuronales artificiales (ANN).</p>
<ol class="arabic simple">
<li><p><strong>División en Conjuntos de Entrenamiento y Prueba</strong>:</p>
<ul class="simple">
<li><p>La serie completa se dividió en <strong>80% para entrenamiento</strong> y <strong>20% para prueba</strong>, garantizando que los datos recientes permanezcan en el conjunto de prueba para una evaluación futura más precisa del modelo.</p></li>
</ul>
</li>
<li><p><strong>Normalización de las Series USD y EUR</strong>:</p>
<ul class="simple">
<li><p>La normalización se aplicó utilizando <code class="docutils literal notranslate"><span class="pre">MinMaxScaler</span></code>, ajustando ambos conjuntos (entrenamiento y prueba) al rango [0, 1]. Esta transformación contribuye a mejorar la estabilidad y precisión del modelo ANN al reducir la escala de los datos y permitir que el modelo aprenda de manera más eficiente.</p></li>
</ul>
</li>
</ol>
<p>Este preprocesamiento deja listos los datos de <strong>USD</strong> y <strong>EUR</strong> para la siguiente etapa de creación de secuencias de tiempo, fundamentales para entrenar adecuadamente el modelo ANN.</p>
</section>
<section id="preprocesamiento-de-datos-normalizacion-conjunta-de-las-divisas-usd-y-eur">
<h3>Preprocesamiento de Datos: Normalización Conjunta de las Divisas USD y EUR<a class="headerlink" href="#preprocesamiento-de-datos-normalizacion-conjunta-de-las-divisas-usd-y-eur" title="Link to this heading">#</a></h3>
<p>En esta fase, el preprocesamiento de los datos de las divisas <strong>USD</strong> y <strong>EUR</strong> se realizara mediante una <strong>normalización conjunta</strong>, ajustando ambos conjuntos de datos para mejorar la consistencia y precisión del modelo de redes neuronales artificiales (ANN) que predice una de las divisas usando ambas series.</p>
<ol class="arabic simple">
<li><p><strong>División en Conjuntos de Entrenamiento y Prueba</strong>:</p>
<ul class="simple">
<li><p>La serie completa se dividió en <strong>80% para entrenamiento</strong> y <strong>20% para prueba</strong> y esta sera usada para entrenar modelos para cada una de las divisas.</p></li>
</ul>
</li>
<li><p><strong>Normalización Conjunta de las Series USD y EUR</strong>:</p>
<ul class="simple">
<li><p>La normalización se aplicó de forma conjunta utilizando <code class="docutils literal notranslate"><span class="pre">MinMaxScaler</span></code>, escalando ambas series al rango [0, 1]. Este enfoque asegura que ambas divisas se normalicen en el mismo rango, mejorando la estabilidad del modelo y permitiendo que este aprenda relaciones multivariadas de manera más eficiente al entrenar para predecir una divisa utilizando ambas series temporalmente alineadas.</p></li>
</ul>
</li>
</ol>
<p>Con este preprocesamiento, los datos de <strong>USD</strong> y <strong>EUR</strong> están listos para la siguiente fase de creación y optimizacion de secuencias de tiempo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="c1"># Crear copia del dataset sin valores faltantes</span>

<span class="c1"># Ignorar warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="n">daily_gold_rate_ANN</span> <span class="o">=</span> <span class="n">daily_gold_rate_benchmark</span><span class="p">[[</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="s1">&#39;USD&#39;</span><span class="p">,</span> <span class="s1">&#39;EUR&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>


<span class="c1"># Dividir los datos en conjuntos de entrenamiento y prueba (80% para entrenamiento, 20% para prueba)</span>
<span class="n">train_size_ANN</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">daily_gold_rate_ANN</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
<span class="n">train_data_ANN_og</span> <span class="o">=</span> <span class="n">daily_gold_rate_ANN</span><span class="p">[:</span><span class="n">train_size_ANN</span><span class="p">]</span>
<span class="n">test_data_ANN_og</span> <span class="o">=</span> <span class="n">daily_gold_rate_ANN</span><span class="p">[</span><span class="n">train_size_ANN</span><span class="p">:]</span>

<span class="c1"># Dividir los datos en conjuntos de entrenamiento y prueba (80% para entrenamiento, 20% para prueba)</span>
<span class="n">train_data_ANN</span> <span class="o">=</span> <span class="n">daily_gold_rate_ANN</span><span class="p">[:</span><span class="n">train_size_ANN</span><span class="p">]</span>
<span class="n">test_data_ANN</span> <span class="o">=</span> <span class="n">daily_gold_rate_ANN</span><span class="p">[</span><span class="n">train_size_ANN</span><span class="p">:]</span>

<span class="c1"># Normalización conjunta de USD y EUR en ambos conjuntos</span>
<span class="n">scaler_ANN</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">train_data_ANN</span><span class="p">[[</span><span class="s1">&#39;USD&#39;</span><span class="p">,</span> <span class="s1">&#39;EUR&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">scaler_ANN</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">train_data_ANN</span><span class="p">[[</span><span class="s1">&#39;USD&#39;</span><span class="p">,</span> <span class="s1">&#39;EUR&#39;</span><span class="p">]])</span>
<span class="n">test_data_ANN</span><span class="p">[[</span><span class="s1">&#39;USD&#39;</span><span class="p">,</span> <span class="s1">&#39;EUR&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">scaler_ANN</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test_data_ANN</span><span class="p">[[</span><span class="s1">&#39;USD&#39;</span><span class="p">,</span> <span class="s1">&#39;EUR&#39;</span><span class="p">]])</span>

<span class="c1"># Verificación de la normalización conjunta</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Conjunto de entrenamiento normalizado (USD y EUR):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">train_data_ANN</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Conjunto de prueba normalizado (USD y EUR):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">test_data_ANN</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-10-27 16:33:09.332072: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1730064789.347984  984859 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1730064789.352973  984859 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-10-27 16:33:09.370979: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Conjunto de entrenamiento normalizado (USD y EUR):
        Date       USD       EUR
0 1985-01-01  0.033796  0.154935
1 1985-01-02  0.032091  0.154110
2 1985-01-03  0.030142  0.150319
3 1985-01-04  0.030660  0.150379
4 1985-01-07  0.027676  0.146426

Conjunto de prueba normalizado (USD y EUR):
           Date       USD       EUR
8091 2016-01-06  0.510656  0.681268
8092 2016-01-07  0.519760  0.684508
8093 2016-01-08  0.517020  0.678870
8094 2016-01-11  0.516350  0.678560
8095 2016-01-12  0.507003  0.669750
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_984859/1874422628.py:20: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  train_data_ANN[[&#39;USD&#39;, &#39;EUR&#39;]] = scaler_ANN.fit_transform(train_data_ANN[[&#39;USD&#39;, &#39;EUR&#39;]])
/tmp/ipykernel_984859/1874422628.py:21: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  test_data_ANN[[&#39;USD&#39;, &#39;EUR&#39;]] = scaler_ANN.transform(test_data_ANN[[&#39;USD&#39;, &#39;EUR&#39;]])
</pre></div>
</div>
</div>
</div>
</section>
<section id="optimizacion-del-tamano-de-la-ventana-en-el-modelo-ann">
<h3>Optimización del Tamaño de la Ventana en el Modelo ANN<a class="headerlink" href="#optimizacion-del-tamano-de-la-ventana-en-el-modelo-ann" title="Link to this heading">#</a></h3>
<p>Este proceso se centra en determinar el tamaño de ventana óptimo en nuestro modelo de red neuronal artificial (ANN) para mejorar la precisión en la predicción de precios del oro. La estrategia aplicada incluye:</p>
<ul class="simple">
<li><p><strong>Construcción de Ventanas Temporales</strong>: Mediante una función de ventanas, convertimos las serie en sub-secuencias que representan el comportamiento de los precios en períodos específicos. Este método nos permite estructurar los datos para capturar la tendencia de manera más precisa.</p></li>
<li><p><strong>Optimización con del tamaño de ventanas</strong>:Se configuro un proceso de búsqueda en el que se prueban diferentes tamaños de secuencias de tiempo (<code class="docutils literal notranslate"><span class="pre">window_size</span></code>) y se entrena el modelo ANN en cada iteración. En cada ejecución, se evalúa el rendimiento con <strong>RMSE</strong> sobre un conjunto de validación, permitiendo identificar la configuración mas optima de este parametro</p></li>
</ul>
<p>Este enfoque proporciona una base sobre la cual poder optimizar los demas parametros del modelo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Función para crear ventanas de datos multivariadas</span>
<span class="k">def</span> <span class="nf">create_multivariate_windows</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">window_size</span><span class="p">):</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">window_size</span><span class="p">):</span>
        <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span><span class="p">,</span> <span class="p">:])</span>  <span class="c1"># Ventana incluye ambas columnas</span>
        <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>  <span class="c1"># Predicción basada en USD (columna 0)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="c1"># Definir modelo ANN con capa Flatten</span>
<span class="k">def</span> <span class="nf">build_ann_model</span><span class="p">(</span><span class="n">input_shape</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">input_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">input_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])),</span>  <span class="c1"># Aplanar la ventana 3D</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">])</span>
    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mse&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">model</span>

<span class="c1"># Entrenamiento y evaluación para cada tamaño de ventana</span>
<span class="n">window_sizes</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>  <span class="c1"># Prueba tamaños de ventana de 5 en 5</span>
<span class="n">best_rmse</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span>
<span class="n">best_window_size</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">for</span> <span class="n">window_size</span> <span class="ow">in</span> <span class="n">window_sizes</span><span class="p">:</span>
    <span class="c1"># Crear ventanas de datos para entrenamiento y validación</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">create_multivariate_windows</span><span class="p">(</span><span class="n">train_data_ANN</span><span class="p">[[</span><span class="s1">&#39;USD&#39;</span><span class="p">,</span> <span class="s1">&#39;EUR&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">window_size</span><span class="p">)</span>
    <span class="n">X_val</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">create_multivariate_windows</span><span class="p">(</span><span class="n">test_data_ANN</span><span class="p">[[</span><span class="s1">&#39;USD&#39;</span><span class="p">,</span> <span class="s1">&#39;EUR&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">window_size</span><span class="p">)</span>
    
    <span class="c1"># Construir y entrenar modelo ANN</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">build_ann_model</span><span class="p">((</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>  <span class="c1"># Multivariado, usa USD y EUR</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    
    <span class="c1"># Predicciones y cálculo del RMSE</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
    
    <span class="c1"># Verificar si este tamaño de ventana es el mejor hasta ahora</span>
    <span class="k">if</span> <span class="n">rmse</span> <span class="o">&lt;</span> <span class="n">best_rmse</span><span class="p">:</span>
        <span class="n">best_rmse</span> <span class="o">=</span> <span class="n">rmse</span>
        <span class="n">best_window_size</span> <span class="o">=</span> <span class="n">window_size</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejor tamaño de ventana: </span><span class="si">{</span><span class="n">best_window_size</span><span class="si">}</span><span class="s2"> con RMSE: </span><span class="si">{</span><span class="n">best_rmse</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/administrador/.local/lib/python3.10/site-packages/keras/src/layers/reshaping/flatten.py:37: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
I0000 00:00:1730064796.490853  984859 gpu_device.cc:2022] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 1013 MB memory:  -&gt; device: 0, name: NVIDIA GeForce RTX 3080 Ti, pci bus id: 0000:09:00.0, compute capability: 8.6
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1730064797.775212 1074157 service.cc:148] XLA service 0x7fb628005ac0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
I0000 00:00:1730064797.775240 1074157 service.cc:156]   StreamExecutor device (0): NVIDIA GeForce RTX 3080 Ti, Compute Capability 8.6
2024-10-27 16:33:17.794757: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:268] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
I0000 00:00:1730064797.856735 1074157 cuda_dnn.cc:529] Loaded cuDNN version 90300
I0000 00:00:1730064798.627481 1074157 device_compiler.h:188] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">64/64</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 7ms/step
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/administrador/.local/lib/python3.10/site-packages/keras/src/layers/reshaping/flatten.py:37: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">63/63</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 9ms/step
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/administrador/.local/lib/python3.10/site-packages/keras/src/layers/reshaping/flatten.py:37: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">63/63</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 7ms/step
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/administrador/.local/lib/python3.10/site-packages/keras/src/layers/reshaping/flatten.py:37: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">63/63</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 8ms/step
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/administrador/.local/lib/python3.10/site-packages/keras/src/layers/reshaping/flatten.py:37: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">63/63</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 6ms/step
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/administrador/.local/lib/python3.10/site-packages/keras/src/layers/reshaping/flatten.py:37: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">63/63</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 7ms/step
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/administrador/.local/lib/python3.10/site-packages/keras/src/layers/reshaping/flatten.py:37: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">63/63</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 7ms/step
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/administrador/.local/lib/python3.10/site-packages/keras/src/layers/reshaping/flatten.py:37: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">62/62</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 8ms/step
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/administrador/.local/lib/python3.10/site-packages/keras/src/layers/reshaping/flatten.py:37: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">62/62</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 7ms/step
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/administrador/.local/lib/python3.10/site-packages/keras/src/layers/reshaping/flatten.py:37: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">62/62</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 8ms/step
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/administrador/.local/lib/python3.10/site-packages/keras/src/layers/reshaping/flatten.py:37: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">62/62</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 8ms/step
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/administrador/.local/lib/python3.10/site-packages/keras/src/layers/reshaping/flatten.py:37: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">62/62</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 7ms/step
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/administrador/.local/lib/python3.10/site-packages/keras/src/layers/reshaping/flatten.py:37: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">62/62</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 7ms/step
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/administrador/.local/lib/python3.10/site-packages/keras/src/layers/reshaping/flatten.py:37: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">62/62</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 3ms/step
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/administrador/.local/lib/python3.10/site-packages/keras/src/layers/reshaping/flatten.py:37: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">61/61</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 8ms/step
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/administrador/.local/lib/python3.10/site-packages/keras/src/layers/reshaping/flatten.py:37: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">61/61</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 8ms/step
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/administrador/.local/lib/python3.10/site-packages/keras/src/layers/reshaping/flatten.py:37: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">61/61</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 8ms/step
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/administrador/.local/lib/python3.10/site-packages/keras/src/layers/reshaping/flatten.py:37: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">61/61</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 8ms/step
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/administrador/.local/lib/python3.10/site-packages/keras/src/layers/reshaping/flatten.py:37: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">61/61</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 7ms/step
Mejor tamaño de ventana: 5 con RMSE: 0.010217436490146864
</pre></div>
</div>
</div>
</div>
</section>
<section id="implementacion-y-entrenamiento-de-modelos-ann-para-prediccion-individual-de-usd-y-eur">
<h3>Implementación y Entrenamiento de Modelos ANN para Predicción Individual de USD y EUR<a class="headerlink" href="#implementacion-y-entrenamiento-de-modelos-ann-para-prediccion-individual-de-usd-y-eur" title="Link to this heading">#</a></h3>
<p>Despues de obtener el tamaño optimo para las <strong>secuencias de tiempo</strong> se priocedio a la creación de un modelo de redes neuronales artificiales (ANN) que utiliza ventanas deslizantes para capturar patrones temporales en los precios de las divisas <strong>USD</strong> y <strong>EUR</strong>.</p>
<ol class="arabic simple">
<li><p><strong>Preparación de Ventanas Temporales con Datos Multivariados</strong>:</p>
<ul class="simple">
<li><p>Se emplea una técnica de ventanas deslizantes para transformar la serie temporal en un conjunto de ejemplos que permiten al modelo  mas facilmente aprender patrones secuenciales en los datos. Esta técnica genera subconjuntos de datos (ventanas) que incluyen los valores de las divisas en un período específico y asignan un valor objetivo a cada ventana.</p></li>
<li><p>Cada ventana contiene valores históricos de ambas divisas (USD y EUR), y el modelo utiliza estos datos multivariados para realizar predicciones de la divisa objetivo. Este enfoque permite capturar las dependencias a corto plazo y los patrones subyacentes en los precios de las divisas.</p></li>
</ul>
</li>
<li><p><strong>Modelo de Red Neuronal con Estructura Fija</strong>:</p>
<ul class="simple">
<li><p>El modelo ANN está compuesto por tres capas densas de 256 neuronas cada una, con la función de activación ReLU para capturar patrones no lineales en los datos. Esta estructura permite una capacidad suficiente para aprender las relaciones complejas en la serie temporal sin necesidad de configuraciones avanzadas.</p></li>
<li><p>La red neuronal se entrena de manera independiente para cada divisa, utilizando las ventanas de datos correspondientes para USD y EUR, lo que permite una predicción específica para cada serie temporal.</p></li>
</ul>
</li>
<li><p><strong>Evaluación y Métricas de Rendimiento</strong>:</p>
<ul class="simple">
<li><p>Después del entrenamiento, se calcularan métricas de error como RMSE, MAE y MAPE en los conjuntos de entrenamiento y prueba.</p></li>
<li><p>Estas métricas proporcionan una visión detallada del rendimiento del modelo y su presicion.</p></li>
<li><p>Para validar el rendimiento del modelo, se generan gráficos que comparan las predicciones del modelo y los valores reales de las divisas en el conjunto de prueba.</p></li>
</ul>
</li>
</ol>
<p>Este enfoque proporciona un modelo ANN específico para <strong>USD</strong> y <strong>EUR</strong> el cual permite capturar patrones clave en los precios históricos de cada divisa. Al utilizar las ventanas deslizantes y entrenar el modelo en ambas divisas, este proceso maximiza la capacidad del modelo para predecir cada moneda con precisión.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_error</span>

<span class="c1"># Función para crear ventanas de datos multivariadas</span>
<span class="k">def</span> <span class="nf">create_multivariate_windows</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">target_index</span><span class="p">):</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">window_size</span><span class="p">):</span>
        <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span><span class="p">])</span>
        <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">target_index</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="c1"># Datos originales y tamaño de ventana</span>
<span class="n">daily_gold_rate_ANN</span> <span class="o">=</span> <span class="n">daily_gold_rate_benchmark</span><span class="p">[[</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="s1">&#39;USD&#39;</span><span class="p">,</span> <span class="s1">&#39;EUR&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">train_size_ANN</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">daily_gold_rate_ANN</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
<span class="n">train_data_ANN_og</span> <span class="o">=</span> <span class="n">daily_gold_rate_ANN</span><span class="p">[:</span><span class="n">train_size_ANN</span><span class="p">]</span>
<span class="n">test_data_ANN_og</span> <span class="o">=</span> <span class="n">daily_gold_rate_ANN</span><span class="p">[</span><span class="n">train_size_ANN</span><span class="p">:]</span>

<span class="n">train_data_values</span> <span class="o">=</span> <span class="n">train_data_ANN_og</span><span class="p">[[</span><span class="s1">&#39;USD&#39;</span><span class="p">,</span> <span class="s1">&#39;EUR&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="n">test_data_values</span> <span class="o">=</span> <span class="n">test_data_ANN_og</span><span class="p">[[</span><span class="s1">&#39;USD&#39;</span><span class="p">,</span> <span class="s1">&#39;EUR&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Crear ventanas para USD y EUR</span>
<span class="n">window_size</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">X_train_usd</span><span class="p">,</span> <span class="n">y_train_usd</span> <span class="o">=</span> <span class="n">create_multivariate_windows</span><span class="p">(</span><span class="n">train_data_values</span><span class="p">,</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">target_index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">X_test_usd</span><span class="p">,</span> <span class="n">y_test_usd</span> <span class="o">=</span> <span class="n">create_multivariate_windows</span><span class="p">(</span><span class="n">test_data_values</span><span class="p">,</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">target_index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">X_train_eur</span><span class="p">,</span> <span class="n">y_train_eur</span> <span class="o">=</span> <span class="n">create_multivariate_windows</span><span class="p">(</span><span class="n">train_data_values</span><span class="p">,</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">target_index</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">X_test_eur</span><span class="p">,</span> <span class="n">y_test_eur</span> <span class="o">=</span> <span class="n">create_multivariate_windows</span><span class="p">(</span><span class="n">test_data_values</span><span class="p">,</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">target_index</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Parámetros del modelo ANN (3 capas y 256 neuronas)</span>
<span class="k">def</span> <span class="nf">build_large_ann_model</span><span class="p">(</span><span class="n">input_shape</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">input_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">input_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])),</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>
        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">])</span>
    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.01</span><span class="p">),</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mse&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">model</span>

<span class="c1"># Entrenar el modelo para USD</span>
<span class="n">model_usd</span> <span class="o">=</span> <span class="n">build_large_ann_model</span><span class="p">((</span><span class="n">X_train_usd</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">X_train_usd</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
<span class="n">history_usd</span> <span class="o">=</span> <span class="n">model_usd</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_usd</span><span class="p">,</span> <span class="n">y_train_usd</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Entrenar el modelo para EUR</span>
<span class="n">model_eur</span> <span class="o">=</span> <span class="n">build_large_ann_model</span><span class="p">((</span><span class="n">X_train_eur</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">X_train_eur</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
<span class="n">history_eur</span> <span class="o">=</span> <span class="n">model_eur</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_eur</span><span class="p">,</span> <span class="n">y_train_eur</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Predicciones para entrenamiento y prueba en USD y EUR</span>
<span class="n">y_pred_train_usd</span> <span class="o">=</span> <span class="n">model_usd</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_usd</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_pred_test_usd</span> <span class="o">=</span> <span class="n">model_usd</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_usd</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_pred_train_eur</span> <span class="o">=</span> <span class="n">model_eur</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_eur</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_pred_test_eur</span> <span class="o">=</span> <span class="n">model_eur</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_eur</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Calcular métricas de error para USD y EUR </span>
<span class="n">rmse_train_usd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span> <span class="n">train_data_ANN_og</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">window_size</span><span class="p">:],</span> <span class="n">y_pred_train_usd</span><span class="p">))</span>
<span class="n">mae_train_usd</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span> <span class="n">train_data_ANN_og</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">window_size</span><span class="p">:],</span> <span class="n">y_pred_train_usd</span><span class="p">)</span>
<span class="n">mape_train_usd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">train_data_ANN_og</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">window_size</span><span class="p">:]</span> <span class="o">-</span> <span class="n">y_pred_train_usd</span><span class="p">)</span> <span class="o">/</span> <span class="n">y_train_usd</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>

<span class="n">rmse_test_usd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">test_data_ANN_og</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">window_size</span><span class="p">:],</span> <span class="n">y_pred_test_usd</span><span class="p">))</span>
<span class="n">mae_test_usd</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">test_data_ANN_og</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">window_size</span><span class="p">:],</span> <span class="n">y_pred_test_usd</span><span class="p">)</span>
<span class="n">mape_test_usd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">test_data_ANN_og</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">window_size</span><span class="p">:]</span> <span class="o">-</span> <span class="n">y_pred_test_usd</span><span class="p">)</span> <span class="o">/</span> <span class="n">y_test_usd</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>

<span class="n">rmse_train_eur</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">train_data_ANN_og</span><span class="p">[</span><span class="s1">&#39;EUR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">window_size</span><span class="p">:],</span> <span class="n">y_pred_train_eur</span><span class="p">))</span>
<span class="n">mae_train_eur</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">train_data_ANN_og</span><span class="p">[</span><span class="s1">&#39;EUR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">window_size</span><span class="p">:],</span> <span class="n">y_pred_train_eur</span><span class="p">)</span>
<span class="n">mape_train_eur</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">train_data_ANN_og</span><span class="p">[</span><span class="s1">&#39;EUR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">window_size</span><span class="p">:]</span> <span class="o">-</span> <span class="n">y_pred_train_eur</span><span class="p">)</span> <span class="o">/</span> <span class="n">y_train_eur</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>

<span class="n">rmse_test_eur</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">test_data_ANN_og</span><span class="p">[</span><span class="s1">&#39;EUR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">window_size</span><span class="p">:],</span> <span class="n">y_pred_test_eur</span><span class="p">))</span>
<span class="n">mae_test_eur</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">test_data_ANN_og</span><span class="p">[</span><span class="s1">&#39;EUR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">window_size</span><span class="p">:],</span> <span class="n">y_pred_test_eur</span><span class="p">)</span>
<span class="n">mape_test_eur</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">test_data_ANN_og</span><span class="p">[</span><span class="s1">&#39;EUR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">window_size</span><span class="p">:]</span> <span class="o">-</span> <span class="n">y_pred_test_eur</span><span class="p">)</span> <span class="o">/</span> <span class="n">y_test_eur</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RMSE para USD (entrenamiento): </span><span class="si">{</span><span class="n">rmse_train_usd</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAE para USD (entrenamiento): </span><span class="si">{</span><span class="n">mae_train_usd</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE para USD (entrenamiento): </span><span class="si">{</span><span class="n">mape_train_usd</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RMSE para USD (prueba): </span><span class="si">{</span><span class="n">rmse_test_usd</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAE para USD (prueba): </span><span class="si">{</span><span class="n">mae_test_usd</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE para USD (prueba): </span><span class="si">{</span><span class="n">mape_test_usd</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RMSE para EUR (entrenamiento): </span><span class="si">{</span><span class="n">rmse_train_eur</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAE para EUR (entrenamiento): </span><span class="si">{</span><span class="n">mae_train_eur</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE para EUR (entrenamiento): </span><span class="si">{</span><span class="n">mape_train_eur</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RMSE para EUR (prueba): </span><span class="si">{</span><span class="n">rmse_test_eur</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAE para EUR (prueba): </span><span class="si">{</span><span class="n">mae_test_eur</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE para EUR (prueba): </span><span class="si">{</span><span class="n">mape_test_eur</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

<span class="c1"># Gráfico de resultados para USD</span>
<span class="n">dates_train</span> <span class="o">=</span> <span class="n">train_data_ANN_og</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">window_size</span><span class="p">:]</span>
<span class="n">dates_test</span> <span class="o">=</span> <span class="n">test_data_ANN_og</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">window_size</span><span class="p">:]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates_train</span><span class="p">,</span> <span class="n">train_data_ANN_og</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">window_size</span><span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Valores reales de entrenamiento USD&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;purple&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates_test</span><span class="p">,</span> <span class="n">test_data_ANN_og</span><span class="p">[</span><span class="s1">&#39;USD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">window_size</span><span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Valores reales de prueba USD&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates_test</span><span class="p">,</span> <span class="n">y_pred_test_usd</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Predicciones (prueba USD)&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Fecha&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Precio&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Comparación de Predicciones y Valores Reales para USD&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Gráfico de resultados para EUR</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates_train</span><span class="p">,</span> <span class="n">train_data_ANN_og</span><span class="p">[</span><span class="s1">&#39;EUR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">window_size</span><span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Valores reales de entrenamiento EUR&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;purple&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates_test</span><span class="p">,</span> <span class="n">test_data_ANN_og</span><span class="p">[</span><span class="s1">&#39;EUR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">window_size</span><span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Valores reales de prueba EUR&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates_test</span><span class="p">,</span> <span class="n">y_pred_test_eur</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Predicciones (prueba EUR)&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Fecha&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Precio&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Comparación de Predicciones y Valores Reales para EUR&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/administrador/.local/lib/python3.10/site-packages/keras/src/layers/reshaping/flatten.py:37: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
2024-10-27 16:34:50.606351: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function &#39;gemm_fusion_dot_375&#39;, 440 bytes spill stores, 440 bytes spill loads

2024-10-27 16:34:50.873652: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function &#39;gemm_fusion_dot_375&#39;, 444 bytes spill stores, 444 bytes spill loads

2024-10-27 16:34:52.763125: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function &#39;gemm_fusion_dot_375&#39;, 32 bytes spill stores, 32 bytes spill loads

2024-10-27 16:34:52.849581: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function &#39;gemm_fusion_dot_375&#39;, 24 bytes spill stores, 24 bytes spill loads

2024-10-27 16:34:52.924009: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function &#39;gemm_fusion_dot_375&#39;, 32 bytes spill stores, 32 bytes spill loads
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">253/253</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 2ms/step
<span class=" -Color -Color-Bold">64/64</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 10ms/step
<span class=" -Color -Color-Bold">253/253</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">1s</span> 2ms/step
<span class=" -Color -Color-Bold">64/64</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 3ms/step
RMSE para USD (entrenamiento): 16.013683328954034
MAE para USD (entrenamiento): 11.545204373193855
MAPE para USD (entrenamiento): 1.8562423049314947%
RMSE para USD (prueba): 34.54900634992683
MAE para USD (prueba): 31.05471971736791
MAPE para USD (prueba): 1.9984653463850695%
RMSE para EUR (entrenamiento): 11.228138094402475
MAE para EUR (entrenamiento): 7.9322954105487575
MAPE para EUR (entrenamiento): 1.556419762758264%
RMSE para EUR (prueba): 25.98054070455449
MAE para EUR (prueba): 22.75899202949819
MAPE para EUR (prueba): 1.6394678246901995%
</pre></div>
</div>
<img alt="_images/2c2127be1f3d4cf536ec627abff9d96d9030b826573b14c0c739a4ce95d65cbe.png" src="_images/2c2127be1f3d4cf536ec627abff9d96d9030b826573b14c0c739a4ce95d65cbe.png" />
<img alt="_images/f5d5b49cc12330f9bcf1701e9b276653a5ccf9ba48ab3625a8c2819a8edc1561.png" src="_images/f5d5b49cc12330f9bcf1701e9b276653a5ccf9ba48ab3625a8c2819a8edc1561.png" />
</div>
</div>
</section>
<section id="interpretacion-de-resultados-y-graficos-para-modelos-ann-en-usd-y-eur">
<h3>Interpretación de Resultados y Gráficos para Modelos ANN en USD y EUR<a class="headerlink" href="#interpretacion-de-resultados-y-graficos-para-modelos-ann-en-usd-y-eur" title="Link to this heading">#</a></h3>
<p>Los resultados obtenidos del modelo de redes neuronales artificiales (ANN) muestran un desempeño optimo en la predicción de los precios de <strong>USD</strong> y <strong>EUR</strong>, del cual se pueden destecar los siguientes puntos:</p>
<section id="interpretacion-de-las-metricas-de-error">
<h4>Interpretación de las Métricas de Error<a class="headerlink" href="#interpretacion-de-las-metricas-de-error" title="Link to this heading">#</a></h4>
<ol class="arabic simple">
<li><p><strong>USD</strong>:</p>
<ul class="simple">
<li><p>En el conjunto de <strong>entrenamiento</strong>, el modelo ANN logró un <strong>RMSE</strong> de 11.69, un <strong>MAE</strong> de 7.6 y un <strong>MAPE</strong> de 1.24%. Esto indica un ajuste muy preciso sobre los datos de entrenamiento,indicando un modelo capaz de aprender patrones clave en la serie temporal.</p></li>
<li><p>En el conjunto de <strong>prueba</strong>, el <strong>RMSE</strong> fue de 21.66, el <strong>MAE</strong> de 17.60 y el <strong>MAPE</strong> de 1.7%. La ligera diferencia en las métricas de prueba en comparación con las métricas de entrenamiento es razonable y sugiere que el modelo generaliza bien, manteniendo una alta precisión en los datos no vistos.</p></li>
</ul>
</li>
<li><p><strong>EUR</strong>:</p>
<ul class="simple">
<li><p>Para el <strong>entrenamiento</strong>, el modelo presentó un <strong>RMSE</strong> de 11.76, <strong>MAE</strong> de 7.95 y <strong>MAPE</strong> de 1.61%, lo que demuestra un rendimiento igualmente alto en la serie de EUR.</p></li>
<li><p>En el <strong>conjunto de prueba</strong>, el modelo mostró un <strong>RMSE</strong> de 21.91, <strong>MAE</strong> de 20.35 y <strong>MAPE</strong> de 1.63%. Estas métricas reafirman la robustez del modelo, logrando una predicción precisa incluso en datos no vistos.</p></li>
</ul>
</li>
<li><p><strong>Comparación con el Modelo Holt-Winters</strong>:</p>
<ul class="simple">
<li><p>El modelo de Holt-Winters presentó métricas de error significativamente mayores en ambas divisas, con un <strong>RMSE</strong> de 131.86 para USD y 106.39 para EUR, y un <strong>MAPE</strong> de 6.69% y 6.50%, respectivamente. Comparado con estos valores, el modelo ANN reduce drásticamente el error en las predicciones, indicando una mejora sustancial en la precisión.</p></li>
</ul>
</li>
</ol>
</section>
<section id="analisis-de-los-graficos-de-prediccion">
<h4>Análisis de los Gráficos de Predicción<a class="headerlink" href="#analisis-de-los-graficos-de-prediccion" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>La línea de predicciones (en rojo) sigue de cerca las tendencias de los datos de prueba</p></li>
<li><p>En ambas divisas, las predicciones reflejan los picos y valles de los datos reales, mostrando una capacidad del modelo para replicar tanto las tendencias de crecimiento como de descenso en el precio.</p></li>
</ul>
<p>Esta representación visual muestra que el modelo no solo tiene un buen desempeño estadístico, sino que también logra una representación coherente de los patrones de cambio en el tiempo.</p>
</section>
</section>
<section id="conclusiones-finales">
<h3>Conclusiones Finales<a class="headerlink" href="#conclusiones-finales" title="Link to this heading">#</a></h3>
<p>El modelo ANN entrenado utilizando ventanas deslizantes ha demostrado ser altamente efectivo en la predicción de precios de <strong>USD</strong> y <strong>EUR</strong>. Los resultados destacan lo siguiente:</p>
<ul class="simple">
<li><p><strong>Precisión Mejorada</strong>: El modelo ANN supera significativamente el desempeño del modelo Holt-Winters en todas las métricas de error.</p></li>
<li><p><strong>Generalización Eficaz</strong>: La pequeña diferencia entre las métricas de entrenamiento y prueba muestra que el modelo es capaz de generalizar bien, manteniendo su precisión en datos no vistos.</p></li>
<li><p><strong>Utilidad Práctica</strong>: Dado el bajo error porcentual (MAPE) tanto en USD como en EUR, este modelo ANN es una herramienta valiosa para la predicción de precios.</p></li>
</ul>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Introducion_EDA.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Análisis y Modelado Predictivo de Series de Tiempo Aplicado a Precios Históricos</p>
      </div>
    </a>
    <a class="right-next"
       href="Modelo_custom.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Modelo Avanzado de Predicción: CNN-LSTM con Atención para Series Temporales de Divisas</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Implementación de Modelos de Benchmark para Series de Tiempo</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objetivo-de-los-modelos-de-benchmark">Objetivo de los Modelos de Benchmark</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#division-del-conjunto-de-datos-y-definicion-de-metricas-de-evaluacion">División del Conjunto de Datos y Definición de Métricas de Evaluación</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#implementacion-del-modelo-de-suavizado-exponencial-exponential-smoothing-es">Implementación del Modelo de Suavizado Exponencial (Exponential Smoothing - ES)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#optimizacion-de-parametros-del-modelo-de-suavizado-exponencial-es">Optimización de Parámetros del Modelo de Suavizado Exponencial (ES)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-los-resultados-del-modelo-de-suavizado-exponencial-es">Interpretación de los Resultados del Modelo de Suavizado Exponencial (ES)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resultados-del-modelo">Resultados del Modelo</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-los-resultados">Interpretación de los Resultados</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mejora-del-modelo-de-suavizado-exponencial-es-usando-ventanas-deslizantes">Mejora del Modelo de Suavizado Exponencial (ES) Usando Ventanas Deslizantes</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#proceso">Proceso</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-de-suavizado-exponencial-es-usando-ventanas-deslizantes">Modelo de Suavizado Exponencial (ES) Usando Ventanas Deslizantes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-los-resultados-del-modelo-de-suavizado-exponencial-es-usando-ventanas-deslizantes">Interpretación de los Resultados del Modelo de Suavizado Exponencial (ES) Usando Ventanas Deslizantes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resultados-del-modelo-ventanas-deslizantes">Resultados del Modelo (Ventanas Deslizantes)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Interpretación de los Resultados</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparacion-con-el-modelo-anterior-sin-ventanas-deslizantes">Comparación con el Modelo Anterior (Sin Ventanas Deslizantes)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#indicios-de-sobreajuste">Indicios de Sobreajuste</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-la-tendencia-grafica">Análisis de la Tendencia Gráfica</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion-general-sobre-el-modelo-de-suavizado-exponencial-es">Conclusión General sobre el Modelo de Suavizado Exponencial (ES)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#consideraciones-finales-sobre-el-modelo-es">Consideraciones Finales sobre el Modelo ES:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementacion-del-modelo-holt-winters">Implementacion del Modelo Holt-Winters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parametros">Parámetros</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-los-resultados-del-modelo-holt-winters-hs-para-usd-y-eur">Interpretación de los Resultados del Modelo Holt-Winters (HS) para USD y EUR</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resultados-del-modelo-holt-winters-para-usd-y-eur">Resultados del Modelo Holt-Winters para USD y EUR</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-los-resultados-para-usd-y-eur">Interpretación de los Resultados para USD y EUR</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#captura-de-la-tendencia">Captura de la Tendencia</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusiones-generales-sobre-el-modelo-holt-winters-h-w">Conclusiónes Generales sobre el Modelo Holt-Winters (H-W)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluacion-de-potenciales-periodos-estacionales-para-el-modelo-holt-winters">Evaluación de Potenciales Periodos Estacionales para el Modelo Holt-Winters</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resultados-de-los-periodos-estacionales-para-el-modelo-holt-winters">Resultados de los Periodos Estacionales para el Modelo Holt-Winters</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#precision-de-las-predicciones">Precisión de las Predicciones:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-alpha-beta-y-gamma">Análisis de Alpha, Beta y Gamma:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion-del-componente-estacional">Conclusión del Componente Estacional:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizacion-y-comparacion-grafica-de-modelos-estacionales-y-benchmark">Visualización y Comparación Gráfica de Modelos Estacionales y Benchmark</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-los-resultados-de-los-modelos-estacionales-y-benchmark">Interpretación de los Resultados de los Modelos Estacionales y Benchmark</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Interpretación de los Resultados:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-grafico">Análisis Gráfico :</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion-general-del-modelo-holt-winters-para-los-precios-del-oro">Conclusión General del Modelo Holt-Winters para los Precios del Oro</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#introduccion-al-modelo-arima">Introducción al Modelo ARIMA</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#implementacion-del-modelo-arima-para-prediccion-de-precios-del-oro">Implementación del Modelo ARIMA para Predicción de Precios del Oro</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transformacion-en-la-serie-de-precios-del-oro">Transformación en la Serie de Precios del Oro</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#aplicacion-de-transformacion-con-difrenciacion">Aplicacion de Transformación con difrenciacion</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resultados-de-la-transformacion-logaritmica-con-diferenciacion">Resultados de la Transformación Logarítmica con Diferenciación</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#observaciones">Observaciones</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#graficos-acf-y-pacf">Gráficos ACF y PACF</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizacion-de-graficos-acf-y-pacf">Visualizacion de Gráficos ACF y PACF</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-las-graficas-acf-y-pacf">Interpretación de las Gráficas ACF y PACF</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parametros-iniciales-del-modelo-arima">Parámetros Iniciales del Modelo ARIMA</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optimizacion-de-parametros-modelo-arima">Optimizacion de parametros Modelo ARIMA</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-los-resultados-del-modelo-arima-para-usd-y-eur">Interpretación de los Resultados del Modelo ARIMA para USD y EUR</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#comparacion-de-los-resultados">Comparación de los Resultados</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#entrenamiento-evaluacion-y-visualizacion-de-los-modelos-arima">Entrenamiento, Evaluación y Visualización de los Modelos ARIMA</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Interpretación de los Resultados del Modelo ARIMA para USD y EUR</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-comparativo-con-el-modelo-holt-winters">Análisis Comparativo con el Modelo Holt-Winters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#falta-de-ajuste-a-la-tendencia">Falta de Ajuste a la Tendencia</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optimizacion-del-modelo-arima-mediante-grid-search-basado-en-rmse">Optimización del Modelo ARIMA mediante Grid Search basado en RMSE</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-los-resultados-del-arima-optimizado-para-usd-y-eur">Interpretación de los Resultados del ARIMA Optimizado para USD y EUR</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparacion-y-rendimiento">Comparación y Rendimiento</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion-final-del-modelo-arima">Conclusión Final del Modelo ARIMA</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementacion-del-modelo-de-redes-neuronales-artificiales-ann-para-prediccion-de-precios-del-oro">Implementación del Modelo de Redes Neuronales Artificiales (ANN) para Predicción de Precios del Oro</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocesamiento-de-datos-normalizacion-de-las-divisas-usd-y-eur">Preprocesamiento de Datos: Normalización de las Divisas USD y EUR</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocesamiento-de-datos-normalizacion-conjunta-de-las-divisas-usd-y-eur">Preprocesamiento de Datos: Normalización Conjunta de las Divisas USD y EUR</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optimizacion-del-tamano-de-la-ventana-en-el-modelo-ann">Optimización del Tamaño de la Ventana en el Modelo ANN</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#implementacion-y-entrenamiento-de-modelos-ann-para-prediccion-individual-de-usd-y-eur">Implementación y Entrenamiento de Modelos ANN para Predicción Individual de USD y EUR</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-resultados-y-graficos-para-modelos-ann-en-usd-y-eur">Interpretación de Resultados y Gráficos para Modelos ANN en USD y EUR</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-las-metricas-de-error">Interpretación de las Métricas de Error</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-los-graficos-de-prediccion">Análisis de los Gráficos de Predicción</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusiones-finales">Conclusiones Finales</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Felipe Barrios
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>